<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Th·ª≠ T√†i To√°n H·ªçc: L·ª±a Ch·ªçn Bi·ªÉu ƒê·ªì</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap');
        
        body {
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(135deg, #eef2ff 0%, #e0e7ff 100%); /* Indigo theme */
        }

        .card {
            background: white;
            border-radius: 1.5rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            transition: all 0.3s ease;
        }

        .option-btn {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .option-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 4px 6px -1px rgba(79, 70, 229, 0.1);
            background-color: #eef2ff;
            border-color: #6366f1;
        }

        .option-btn.correct {
            background-color: #dcfce7 !important;
            border-color: #22c55e !important;
            color: #14532d !important;
        }

        .option-btn.wrong {
            background-color: #fee2e2 !important;
            border-color: #ef4444 !important;
            color: #7f1d1d !important;
        }

        .emoji-feedback {
            font-size: 3.5rem;
            animation: bounceIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes bounceIn {
            0% { transform: scale(0); opacity: 0; }
            60% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); }
        }

        .progress-bar {
            transition: width 0.6s ease-in-out;
        }

        .badge {
            font-size: 0.8rem;
            padding: 0.35rem 0.85rem;
            border-radius: 9999px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div class="w-full max-w-3xl">
        <!-- Start Screen -->
        <div id="start-screen" class="card p-10 text-center">
            <div class="mb-6 inline-block p-4 bg-indigo-100 rounded-full">
                <span class="text-5xl">üìà</span>
            </div>
            <h1 class="text-4xl md:text-5xl font-extrabold text-indigo-600 mb-3">L·ª±a Ch·ªçn Bi·ªÉu ƒê·ªì</h1>
            <p class="text-gray-500 mb-10 text-lg">To√°n 8 - Ch√¢n tr·ªùi s√°ng t·∫°o (Ch∆∞∆°ng 4 - B√†i 2)</p>
            
            <div class="grid grid-cols-2 gap-6 mb-10 text-left">
                <div class="bg-indigo-50 p-5 rounded-2xl border border-indigo-100 transform hover:scale-105 transition-transform">
                    <span class="text-3xl mb-2 block">üß†</span>
                    <h3 class="font-bold text-gray-800 text-lg">Ki·∫øn th·ª©c</h3>
                    <p class="text-sm text-gray-600">Bi·ªÉu ƒë·ªì c·ªôt, qu·∫°t tr√≤n, ƒëo·∫°n th·∫≥ng...</p>
                </div>
                <div class="bg-pink-50 p-5 rounded-2xl border border-pink-100 transform hover:scale-105 transition-transform">
                    <span class="text-3xl mb-2 block">üéØ</span>
                    <h3 class="font-bold text-gray-800 text-lg">M·ª•c ti√™u</h3>
                    <p class="text-sm text-gray-600">Ch·ªçn ƒë√∫ng lo·∫°i bi·ªÉu ƒë·ªì ph√π h·ª£p</p>
                </div>
            </div>

            <button onclick="startGame()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-8 rounded-xl shadow-lg shadow-indigo-200 transform transition hover:-translate-y-1 text-xl flex items-center justify-center gap-3">
                <span>B·∫Øt ƒê·∫ßu Th·ª≠ Th√°ch</span> üöÄ
            </button>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="hidden">
            <!-- Header -->
            <div class="flex justify-between items-center mb-6 bg-white p-5 rounded-2xl shadow-sm border border-indigo-50">
                <div>
                    <span class="text-gray-400 text-xs font-bold uppercase tracking-wider">C√¢u h·ªèi</span>
                    <div class="text-3xl font-black text-gray-800"><span id="current-question">1</span><span class="text-gray-300 text-xl font-bold">/15</span></div>
                </div>
                <div class="text-right">
                    <span class="text-gray-400 text-xs font-bold uppercase tracking-wider">ƒêi·ªÉm s·ªë</span>
                    <div class="text-3xl font-black text-indigo-600" id="score">0</div>
                </div>
            </div>

            <!-- Progress -->
            <div class="w-full bg-gray-200 rounded-full h-3 mb-8 overflow-hidden">
                <div id="progress" class="bg-indigo-500 h-3 rounded-full progress-bar shadow-[0_0_10px_rgba(99,102,241,0.5)]" style="width: 0%"></div>
            </div>

            <!-- Question Card -->
            <div class="card p-6 md:p-10 mb-6 relative overflow-hidden border-b-4 border-indigo-100">
                <div id="level-badge" class="badge bg-green-100 text-green-700 absolute top-6 right-6">Nh·∫≠n bi·∫øt</div>
                <h2 id="question-text" class="text-xl md:text-2xl font-bold text-gray-800 mt-6 mb-8 leading-relaxed">
                    ƒêang t·∫£i c√¢u h·ªèi...
                </h2>

                <div id="options-container" class="grid gap-4">
                    <!-- Options will be injected here -->
                </div>
            </div>

            <!-- Feedback Modal (Inline) -->
            <div id="feedback-area" class="hidden animate-fade-in-up">
                <div id="feedback-card" class="card p-6 border-l-8 shadow-lg">
                    <div class="flex items-start gap-5">
                        <div id="feedback-icon" class="emoji-feedback">üòé</div>
                        <div class="flex-1">
                            <h3 id="feedback-title" class="text-2xl font-bold mb-2">Tuy·ªát v·ªùi!</h3>
                            <div class="text-xs font-bold text-gray-400 uppercase mb-1 tracking-wide">T·∫°i sao l·∫°i nh∆∞ v·∫≠y?</div>
                            <p id="feedback-text" class="text-gray-700 leading-relaxed text-lg"></p>
                        </div>
                    </div>
                    <button onclick="nextQuestion()" class="mt-6 w-full bg-gray-800 hover:bg-gray-900 text-white font-bold py-3 px-6 rounded-xl transition flex items-center justify-center gap-2 shadow-md">
                        Ti·∫øp t·ª•c h√†nh tr√¨nh <span class="text-xl">‚Üí</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="result-screen" class="hidden card p-10 text-center">
            <div class="mb-8">
                <div class="inline-block p-8 rounded-full bg-yellow-50 border-4 border-yellow-200 mb-4 animate-bounce">
                    <span class="text-7xl">üèÜ</span>
                </div>
                <h2 class="text-4xl font-extrabold text-gray-800 mb-3">K·∫øt Qu·∫£ Chung Cu·ªôc</h2>
                <p class="text-gray-500 text-lg">B·∫°n ƒë√£ ho√†n th√†nh xu·∫•t s·∫Øc th·ª≠ th√°ch!</p>
            </div>

            <div class="bg-indigo-50 rounded-2xl p-8 mb-8 border border-indigo-100">
                <div class="text-indigo-400 font-bold uppercase text-sm mb-2">T·ªïng ƒëi·ªÉm ƒë·∫°t ƒë∆∞·ª£c</div>
                <div class="text-6xl font-black text-indigo-600 mb-4" id="final-score">0</div>
                <div class="h-1 w-20 bg-indigo-200 mx-auto mb-4 rounded-full"></div>
                <p id="result-message" class="text-gray-700 font-semibold text-xl">Tuy·ªát v·ªùi √¥ng m·∫∑t tr·ªùi!</p>
            </div>

            <button onclick="location.reload()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-10 rounded-xl shadow-lg transform transition hover:scale-105 flex items-center justify-center gap-2 mx-auto">
                <span class="text-xl">üîÑ</span> Th·ª≠ L·∫°i L·∫ßn N·ªØa
            </button>
        </div>
    </div>

    <!-- Audio Effects -->
    <audio id="sound-correct" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="sound-wrong" src="https://assets.mixkit.co/active_storage/sfx/2955/2955-preview.mp3"></audio>
    <audio id="sound-finish" src="https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3"></audio>

   <script>
  const questions = [
    // 6 C√¢u Nh·∫≠n bi·∫øt (1-6)
    {
      level: "Nh·∫≠n bi·∫øt",
      question: "Lo·∫°i bi·ªÉu ƒë·ªì n√†o th√≠ch h·ª£p nh·∫•t ƒë·ªÉ bi·ªÉu di·ªÖn s·ª± thay ƒë·ªïi c·ªßa m·ªôt ƒë·∫°i l∆∞·ª£ng theo th·ªùi gian?",
      options: ["Bi·ªÉu ƒë·ªì tranh", "Bi·ªÉu ƒë·ªì c·ªôt", "Bi·ªÉu ƒë·ªì h√¨nh qu·∫°t tr√≤n", "Bi·ªÉu ƒë·ªì ƒëo·∫°n th·∫≥ng"],
      correct: 3,
      rationale: "Bi·ªÉu ƒë·ªì ƒëo·∫°n th·∫≥ng gi√∫p ta d·ªÖ d√†ng nh·∫≠n ra xu h∆∞·ªõng thay ƒë·ªïi (tƒÉng hay gi·∫£m) c·ªßa d·ªØ li·ªáu qua c√°c m·ªëc th·ªùi gian."
    },
    {
      level: "Nh·∫≠n bi·∫øt",
      question: "ƒê·ªÉ bi·ªÉu di·ªÖn t·ªâ l·ªá ph·∫ßn trƒÉm c·ªßa t·ª´ng th√†nh ph·∫ßn so v·ªõi to√†n th·ªÉ, ta n√™n d√πng bi·ªÉu ƒë·ªì n√†o?",
      options: ["Bi·ªÉu ƒë·ªì c·ªôt k√©p", "Bi·ªÉu ƒë·ªì h√¨nh qu·∫°t tr√≤n", "Bi·ªÉu ƒë·ªì ƒëo·∫°n th·∫≥ng", "Bi·ªÉu ƒë·ªì tranh"],
      correct: 1,
      rationale: "Bi·ªÉu ƒë·ªì h√¨nh qu·∫°t tr√≤n l√† l·ª±a ch·ªçn t·ªët nh·∫•t ƒë·ªÉ th·ªÉ hi·ªán c∆° c·∫•u, t·ªâ l·ªá ph·∫ßn trƒÉm c·ªßa c√°c ph·∫ßn trong m·ªôt t·ªïng th·ªÉ (tr√≤n 100%)."
    },
    {
      level: "Nh·∫≠n bi·∫øt",
      question: "Bi·ªÉu ƒë·ªì n√†o th∆∞·ªùng ƒë∆∞·ª£c d√πng ƒë·ªÉ so s√°nh s·ªë li·ªáu c·ªßa hai nh√≥m ƒë·ªëi t∆∞·ª£ng c√πng lo·∫°i?",
      options: ["Bi·ªÉu ƒë·ªì c·ªôt", "Bi·ªÉu ƒë·ªì c·ªôt k√©p", "Bi·ªÉu ƒë·ªì h√¨nh qu·∫°t tr√≤n", "Bi·ªÉu ƒë·ªì ƒëo·∫°n th·∫≥ng"],
      correct: 1,
      rationale: "Bi·ªÉu ƒë·ªì c·ªôt k√©p g·ªìm c√°c c·∫∑p c·ªôt ƒë·∫∑t c·∫°nh nhau, r·∫•t thu·∫≠n ti·ªán ƒë·ªÉ so s√°nh d·ªØ li·ªáu gi·ªØa hai ƒë·ªëi t∆∞·ª£ng (v√≠ d·ª•: nam v√† n·ªØ, nƒÉm nay v√† nƒÉm ngo√°i)."
    },
    {
      level: "Nh·∫≠n bi·∫øt",
      question: "Trong bi·ªÉu ƒë·ªì h√¨nh qu·∫°t tr√≤n, t·ªïng c√°c t·ªâ l·ªá ph·∫ßn trƒÉm c·ªßa c√°c th√†nh ph·∫ßn ph·∫£i b·∫±ng bao nhi√™u?",
      options: ["50%", "90%", "100%", "Tu·ª≥ thu·ªôc v√†o d·ªØ li·ªáu"],
      correct: 2,
      rationale: "Bi·ªÉu ƒë·ªì h√¨nh qu·∫°t tr√≤n bi·ªÉu di·ªÖn m·ªôt 'to√†n th·ªÉ', n√™n t·ªïng c√°c th√†nh ph·∫ßn c·ªông l·∫°i lu√¥n ph·∫£i b·∫±ng ƒë√∫ng 100%."
    },
    {
      level: "Nh·∫≠n bi·∫øt",
      question: "Mu·ªën t·∫°o ·∫•n t∆∞·ª£ng v√† thu h√∫t s·ª± ch√∫ √Ω b·∫±ng c√°c h√¨nh ·∫£nh tr·ª±c quan cho c√°c s·ªë li·ªáu ƒë∆°n gi·∫£n, ta d√πng bi·ªÉu ƒë·ªì n√†o?",
      options: ["Bi·ªÉu ƒë·ªì tranh", "Bi·ªÉu ƒë·ªì c·ªôt", "Bi·ªÉu ƒë·ªì ƒëo·∫°n th·∫≥ng", "Bi·ªÉu ƒë·ªì c·ªôt k√©p"],
      correct: 0,
      rationale: "Bi·ªÉu ƒë·ªì tranh s·ª≠ d·ª•ng c√°c bi·ªÉu t∆∞·ª£ng ho·∫∑c h√¨nh ·∫£nh ƒë·ªÉ ƒë·∫°i di·ªán cho d·ªØ li·ªáu, t·∫°o s·ª± sinh ƒë·ªông v√† d·ªÖ hi·ªÉu cho ng∆∞·ªùi xem."
    },
    {
      level: "Nh·∫≠n bi·∫øt",
      question: "Tr√™n bi·ªÉu ƒë·ªì c·ªôt, chi·ªÅu cao c·ªßa c·ªôt bi·ªÉu di·ªÖn ƒë·∫°i l∆∞·ª£ng n√†o?",
      options: ["T√™n c√°c ƒë·ªëi t∆∞·ª£ng", "Th·ªùi gian th·ªëng k√™", "S·ªë li·ªáu th·ªëng k√™ c·ªßa ƒë·ªëi t∆∞·ª£ng", "ƒê∆°n v·ªã t√≠nh"],
      correct: 2,
      rationale: "Trong bi·ªÉu ƒë·ªì c·ªôt, tr·ª•c ngang th∆∞·ªùng ghi t√™n ƒë·ªëi t∆∞·ª£ng, c√≤n chi·ªÅu cao c·ªßa c·ªôt t∆∞∆°ng ·ª©ng v·ªõi gi√° tr·ªã (s·ªë li·ªáu) c·ªßa ƒë·ªëi t∆∞·ª£ng ƒë√≥."
    },

    // 5 C√¢u Th√¥ng hi·ªÉu (7-11)
    {
      level: "Th√¥ng hi·ªÉu",
      question: "ƒê·ªÉ bi·ªÉu di·ªÖn nhi·ªát ƒë·ªô trung b√¨nh c√°c th√°ng trong nƒÉm t·∫°i TP.HCM nh·∫±m th·∫•y r√µ xu h∆∞·ªõng n√≥ng l√™n hay l·∫°nh ƒëi, ta ch·ªçn bi·ªÉu ƒë·ªì n√†o?",
      options: ["Bi·ªÉu ƒë·ªì tranh", "Bi·ªÉu ƒë·ªì h√¨nh qu·∫°t tr√≤n", "Bi·ªÉu ƒë·ªì ƒëo·∫°n th·∫≥ng", "Bi·ªÉu ƒë·ªì c·ªôt k√©p"],
      correct: 2,
      rationale: "Nhi·ªát ƒë·ªô thay ƒë·ªïi li√™n t·ª•c theo th·ªùi gian (c√°c th√°ng), n√™n bi·ªÉu ƒë·ªì ƒëo·∫°n th·∫≥ng gi√∫p quan s√°t xu h∆∞·ªõng tƒÉng gi·∫£m r√µ nh·∫•t."
    },
    {
      level: "Th√¥ng hi·ªÉu",
      question: "L·ªõp 8A mu·ªën th·ªëng k√™ t·ªâ l·ªá x·∫øp lo·∫°i h·ªçc l·ª±c (Gi·ªèi, Kh√°, ƒê·∫°t, Ch∆∞a ƒë·∫°t) c·ªßa c·∫£ l·ªõp. Bi·ªÉu ƒë·ªì n√†o l√† ph√π h·ª£p nh·∫•t?",
      options: ["Bi·ªÉu ƒë·ªì h√¨nh qu·∫°t tr√≤n", "Bi·ªÉu ƒë·ªì c·ªôt k√©p", "Bi·ªÉu ƒë·ªì ƒëo·∫°n th·∫≥ng", "Bi·ªÉu ƒë·ªì tranh"],
      correct: 0,
      rationale: "X·∫øp lo·∫°i h·ªçc l·ª±c l√† c√°c th√†nh ph·∫ßn t·∫°o n√™n t·ªïng th·ªÉ h·ªçc sinh c·∫£ l·ªõp. D√πng bi·ªÉu ƒë·ªì qu·∫°t tr√≤n ƒë·ªÉ th·∫•y t·ªâ tr·ªçng c·ªßa t·ª´ng lo·∫°i l√† h·ª£p l√Ω nh·∫•t."
    },
    {
      level: "Th√¥ng hi·ªÉu",
      question: "ƒê·ªÉ so s√°nh chi·ªÅu cao trung b√¨nh c·ªßa h·ªçc sinh Nam v√† N·ªØ trong 4 kh·ªëi l·ªõp 6, 7, 8, 9, ta n√™n d√πng:",
      options: ["Bi·ªÉu ƒë·ªì c·ªôt", "Bi·ªÉu ƒë·ªì c·ªôt k√©p", "Bi·ªÉu ƒë·ªì ƒëo·∫°n th·∫≥ng", "Bi·ªÉu ƒë·ªì h√¨nh qu·∫°t tr√≤n"],
      correct: 1,
      rationale: "Ch√∫ng ta c·∫ßn so s√°nh hai ƒë·ªëi t∆∞·ª£ng (Nam, N·ªØ) t·∫°i 4 m·ªëc (c√°c kh·ªëi l·ªõp). Bi·ªÉu ƒë·ªì c·ªôt k√©p gi√∫p ƒë·ªëi chi·∫øu tr·ª±c ti·∫øp s·ª± ch√™nh l·ªách n√†y."
    },
    {
      level: "Th√¥ng hi·ªÉu",
      question: "D·ªØ li·ªáu n√†o sau ƒë√¢y KH√îNG TH·ªÇ bi·ªÉu di·ªÖn b·∫±ng bi·ªÉu ƒë·ªì h√¨nh qu·∫°t tr√≤n?",
      options: ["C∆° c·∫•u GDP c·ªßa Vi·ªát Nam nƒÉm 2022", "T·ªâ l·ªá c√°c lo·∫°i s√°ch trong th∆∞ vi·ªán", "S·ªë l∆∞·ª£ng xe m√°y b√°n ƒë∆∞·ª£c qua c√°c nƒÉm t·ª´ 2015-2020", "K·∫øt qu·∫£ b√¨nh ch·ªçn m√≥n ƒÉn y√™u th√≠ch (t√≠nh theo %)"],
      correct: 2,
      rationale: "S·ªë l∆∞·ª£ng xe m√°y b√°n qua c√°c nƒÉm l√† d·ªØ li·ªáu thay ƒë·ªïi theo th·ªùi gian, kh√¥ng ph·∫£i l√† c√°c ph·∫ßn c·ªßa m·ªôt t·ªïng th·ªÉ, n√™n kh√¥ng d√πng bi·ªÉu ƒë·ªì qu·∫°t tr√≤n."
    },
    {
      level: "Th√¥ng hi·ªÉu",
      question: "B·∫°n Minh mu·ªën so s√°nh s·ªë l∆∞·ª£ng huy ch∆∞∆°ng V√†ng c·ªßa 5 qu·ªëc gia d·∫´n ƒë·∫ßu SEA Games. B·∫°n ·∫•y n√™n ch·ªçn bi·ªÉu ƒë·ªì n√†o?",
      options: ["Bi·ªÉu ƒë·ªì ƒëo·∫°n th·∫≥ng", "Bi·ªÉu ƒë·ªì c·ªôt", "Bi·ªÉu ƒë·ªì h√¨nh qu·∫°t tr√≤n", "Bi·ªÉu ƒë·ªì tranh (v·ªõi s·ªë li·ªáu l·ªõn)"],
      correct: 1,
      rationale: "ƒê·ªÉ so s√°nh s·ªë l∆∞·ª£ng (ƒë·ªô l·ªõn) gi·ªØa c√°c ƒë·ªëi t∆∞·ª£ng ƒë·ªôc l·∫≠p (c√°c qu·ªëc gia), bi·ªÉu ƒë·ªì c·ªôt l√† l·ª±a ch·ªçn chu·∫©n x√°c v√† r√µ r√†ng nh·∫•t."
    },

    // 3 C√¢u V·∫≠n d·ª•ng (12-14)
    {
      level: "V·∫≠n d·ª•ng",
      question: "Doanh thu c·ªßa m·ªôt c√¥ng ty bi·∫øn ƒë·ªông li√™n t·ª•c trong 12 th√°ng qua. Gi√°m ƒë·ªëc mu·ªën nh√¨n th·∫•y 'ƒë·ªô d·ªëc' c·ªßa s·ª± tƒÉng tr∆∞·ªüng. B·∫°n khuy√™n d√πng bi·ªÉu ƒë·ªì n√†o?",
      options: ["Bi·ªÉu ƒë·ªì c·ªôt", "Bi·ªÉu ƒë·ªì c·ªôt k√©p", "Bi·ªÉu ƒë·ªì ƒëo·∫°n th·∫≥ng", "Bi·ªÉu ƒë·ªì h√¨nh qu·∫°t tr√≤n"],
      correct: 2,
      rationale: "ƒê·ªô d·ªëc c·ªßa ƒë∆∞·ªùng n·ªëi trong bi·ªÉu ƒë·ªì ƒëo·∫°n th·∫≥ng ph·∫£n √°nh tr·ª±c quan t·ªëc ƒë·ªô tƒÉng tr∆∞·ªüng (d·ªëc l√™n l√† tƒÉng nhanh, d·ªëc xu·ªëng l√† gi·∫£m)."
    },
    {
      level: "V·∫≠n d·ª•ng (Th·ª±c t·∫ø)",
      question: "Gia ƒë√¨nh Lan ghi ch√©p chi ti√™u th√°ng n√†y: Ti·ªÅn ƒÉn (40%), Ti·ªÅn nh√† (30%), Ti·ªÅn h·ªçc (20%), Kh√°c (10%). ƒê·ªÉ c·∫£ nh√† th·∫•y r√µ kho·∫£n n√†o chi·∫øm t·ªâ tr·ªçng l·ªõn nh·∫•t, Lan n√™n v·∫Ω:",
      options: ["Bi·ªÉu ƒë·ªì c·ªôt", "Bi·ªÉu ƒë·ªì h√¨nh qu·∫°t tr√≤n", "Bi·ªÉu ƒë·ªì ƒëo·∫°n th·∫≥ng", "Bi·ªÉu ƒë·ªì c·ªôt k√©p"],
      correct: 1,
      rationale: "ƒê√¢y l√† b√†i to√°n v·ªÅ c∆° c·∫•u chi ti√™u (c√°c ph·∫ßn trƒÉm c·ªông l·∫°i ƒë·ªß 100%), bi·ªÉu ƒë·ªì h√¨nh qu·∫°t tr√≤n gi√∫p so s√°nh th·ªã ph·∫ßn chi ti√™u t·ªët nh·∫•t."
    },
    {
      level: "V·∫≠n d·ª•ng",
      question: "B·∫£ng s·ªë li·ªáu th·ªëng k√™ s·ªë c√¢y tr·ªìng ƒë∆∞·ª£c c·ªßa l·ªõp 8A v√† 8B trong 3 ng√†y: Th·ª© 6, Th·ª© 7, Ch·ªß Nh·∫≠t. ƒê·ªÉ so s√°nh thi ƒëua gi·ªØa hai l·ªõp trong t·ª´ng ng√†y, ta ch·ªçn:",
      options: ["Hai bi·ªÉu ƒë·ªì h√¨nh qu·∫°t tr√≤n", "Bi·ªÉu ƒë·ªì c·ªôt k√©p", "Bi·ªÉu ƒë·ªì ƒëo·∫°n th·∫≥ng", "Bi·ªÉu ƒë·ªì tranh"],
      correct: 1,
      rationale: "C·∫ßn so s√°nh hai ƒë·ªëi t∆∞·ª£ng (L·ªõp 8A, 8B) song song nhau t·∫°i c√°c th·ªùi ƒëi·ªÉm (c√°c ng√†y), bi·ªÉu ƒë·ªì c·ªôt k√©p l√† l·ª±a ch·ªçn t·ªëi ∆∞u."
    },

    // 1 C√¢u V·∫≠n d·ª•ng cao (15)
    {
      level: "V·∫≠n d·ª•ng cao",
      question: "Mu·ªën so s√°nh s·ª± thay ƒë·ªïi v·ªÅ t·ªëc ƒë·ªô tƒÉng tr∆∞·ªüng kinh t·∫ø (GDP) c·ªßa Vi·ªát Nam v√† Th√°i Lan trong su·ªët 10 nƒÉm qua ƒë·ªÉ th·∫•y n∆∞·ªõc n√†o ·ªïn ƒë·ªãnh h∆°n, ta n√™n d√πng:",
      options: ["Bi·ªÉu ƒë·ªì c·ªôt k√©p", "Bi·ªÉu ƒë·ªì h√¨nh qu·∫°t tr√≤n", "Bi·ªÉu ƒë·ªì ƒëo·∫°n th·∫≥ng (c√≥ 2 ƒë∆∞·ªùng)", "Bi·ªÉu ƒë·ªì tranh"],
      correct: 2,
      rationale: "M·∫∑c d√π c·ªôt k√©p so s√°nh ƒë∆∞·ª£c, nh∆∞ng ƒë·ªÉ th·∫•y 's·ª± ·ªïn ƒë·ªãnh' hay 'xu h∆∞·ªõng' c·ªßa 2 ƒë·ªëi t∆∞·ª£ng qua th·ªùi gian d√†i, bi·ªÉu ƒë·ªì ƒëo·∫°n th·∫≥ng v·ªõi 2 ƒë∆∞·ªùng bi·ªÉu di·ªÖn s·∫Ω gi√∫p so s√°nh ƒë·ªô d·ªëc v√† xu h∆∞·ªõng t·ªët h∆°n."
    }
  ];

  let currentQuestionIndex = 0;
  let score = 0;
  let isAnswering = false;

  // Sound Elements
  const soundCorrect = document.getElementById('sound-correct');
  const soundWrong = document.getElementById('sound-wrong');
  const soundFinish = document.getElementById('sound-finish');

  function playSound(type) {
    if (type === 'correct') { soundCorrect.currentTime = 0; soundCorrect.play().catch(() => {}); }
    if (type === 'wrong') { soundWrong.currentTime = 0; soundWrong.play().catch(() => {}); }
    if (type === 'finish') { soundFinish.currentTime = 0; soundFinish.play().catch(() => {}); }
  }

  // Random options but keep correct answer consistent
  function shuffleWithCorrect(options, correctIndex) {
    const arr = options.map((text, i) => ({ text, isCorrect: i === correctIndex }));
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return {
      options: arr.map(o => o.text),
      correct: arr.findIndex(o => o.isCorrect)
    };
  }

  function startGame() {
    document.getElementById('start-screen').classList.add('hidden');
    document.getElementById('quiz-screen').classList.remove('hidden');
    loadQuestion();
  }

  function loadQuestion() {
    isAnswering = true;
    const q = questions[currentQuestionIndex];

    // Shuffle options each time the question is loaded
    const shuffled = shuffleWithCorrect(q.options, q.correct);
    q.options = shuffled.options;
    q.correct = shuffled.correct;

    // Update UI
    document.getElementById('current-question').innerText = currentQuestionIndex + 1;
    document.getElementById('score').innerText = score;

    // Progress to 100% on last question
    const progressPercent = ((currentQuestionIndex + 1) / questions.length) * 100;
    document.getElementById('progress').style.width = `${progressPercent}%`;

    // Setup Question Card
    document.getElementById('question-text').innerText = q.question;

    // Badge color based on level
    const badge = document.getElementById('level-badge');
    badge.innerText = q.level;
    if (q.level.includes("Nh·∫≠n bi·∫øt")) badge.className = "badge bg-green-100 text-green-700 absolute top-6 right-6";
    else if (q.level.includes("Th√¥ng hi·ªÉu")) badge.className = "badge bg-blue-100 text-blue-700 absolute top-6 right-6";
    else if (q.level.includes("V·∫≠n d·ª•ng cao")) badge.className = "badge bg-purple-100 text-purple-700 absolute top-6 right-6";
    else badge.className = "badge bg-yellow-100 text-yellow-700 absolute top-6 right-6";

    // Hide feedback area & reset animation class (safe even if animation isn't defined)
    const feedbackArea = document.getElementById('feedback-area');
    feedbackArea.classList.add('hidden');
    feedbackArea.classList.remove('animate-fade-in-up');

    // Generate Options
    const container = document.getElementById('options-container');
    container.innerHTML = '';

    q.options.forEach((opt, index) => {
      const btn = document.createElement('button');
      btn.className = `option-btn w-full text-left p-5 rounded-xl border-2 border-indigo-50 bg-white text-gray-700 font-bold text-lg flex items-center shadow-sm`;
      btn.onclick = () => checkAnswer(index, btn);
      btn.innerHTML = `
        <span class="inline-flex items-center justify-center w-10 h-10 bg-indigo-50 rounded-lg text-indigo-600 font-extrabold mr-4 text-lg border border-indigo-100 shrink-0">
          ${String.fromCharCode(65 + index)}
        </span>
        <span>${opt}</span>
      `;
      container.appendChild(btn);
    });
  }

  function checkAnswer(selectedIndex, btnElement) {
    if (!isAnswering) return;
    isAnswering = false;

    const q = questions[currentQuestionIndex];
    const isCorrect = selectedIndex === q.correct;
    const buttons = document.querySelectorAll('.option-btn');

    // Disable all buttons
    buttons.forEach(btn => btn.disabled = true);

    // Highlight answers
    if (isCorrect) {
      btnElement.classList.add('correct');
      score += 10;
      document.getElementById('score').innerText = score;
      playSound('correct');
      fireConfetti();
      showFeedback(true, q.rationale);
    } else {
      btnElement.classList.add('wrong');
      if (buttons[q.correct]) buttons[q.correct].classList.add('correct');
      playSound('wrong');
      showFeedback(false, q.rationale);
    }
  }

  function showFeedback(isCorrect, rationale) {
    const area = document.getElementById('feedback-area');
    const card = document.getElementById('feedback-card');
    const title = document.getElementById('feedback-title');
    const text = document.getElementById('feedback-text');
    const icon = document.getElementById('feedback-icon');

    area.classList.remove('hidden');
    // reflow to restart animation if present
    void area.offsetWidth;
    area.classList.add('animate-fade-in-up');

    if (isCorrect) {
      card.className = "card p-6 border-l-8 border-green-500 bg-green-50 shadow-lg";
      title.className = "text-2xl font-bold mb-2 text-green-700";
      title.innerText = "Ch√≠nh x√°c! üéâ";
      icon.innerText = "ü§©";
    } else {
      card.className = "card p-6 border-l-8 border-red-500 bg-red-50 shadow-lg";
      title.className = "text-2xl font-bold mb-2 text-red-700";
      title.innerText = "Ti·∫øc qu√°! üòÖ";
      icon.innerText = "ü§î";
    }

    text.innerText = rationale;
  }

  function nextQuestion() {
    currentQuestionIndex++;
    if (currentQuestionIndex < questions.length) {
      loadQuestion();
    } else {
      showResult();
    }
  }

  function showResult() {
    document.getElementById('quiz-screen').classList.add('hidden');
    document.getElementById('result-screen').classList.remove('hidden');
    document.getElementById('final-score').innerText = score;
    playSound('finish');
    fireConfetti();

    const msg = document.getElementById('result-message');
    if (score >= 130) msg.innerText = "Xu·∫•t s·∫Øc! B·∫°n l√† b·∫≠c th·∫ßy bi·ªÉu ƒë·ªì! üåü";
    else if (score >= 100) msg.innerText = "Gi·ªèi l·∫Øm! Ki·∫øn th·ª©c r·∫•t v·ªØng v√†ng! üëç";
    else if (score >= 70) msg.innerText = "Kh√° t·ªët! C·ªë g·∫Øng th√™m ch√∫t n·ªØa nh√©! üí™";
    else msg.innerText = "H√£y √¥n l·∫°i b√†i v√† th·ª≠ l·∫°i nh√©! üìö";
  }

  function fireConfetti() {
    var count = 200;
    var defaults = { origin: { y: 0.7 } };

    function fire(particleRatio, opts) {
      confetti(Object.assign({}, defaults, opts, {
        particleCount: Math.floor(count * particleRatio)
      }));
    }

    fire(0.25, { spread: 26, startVelocity: 55 });
    fire(0.2, { spread: 60 });
    fire(0.35, { spread: 100, decay: 0.91, scalar: 0.8 });
    fire(0.1, { spread: 120, startVelocity: 25, decay: 0.92, scalar: 1.2 });
    fire(0.1, { spread: 120, startVelocity: 45 });
  }
</script>
</body>
</html>
