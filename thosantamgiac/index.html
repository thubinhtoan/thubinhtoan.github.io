<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Th·ª£ SƒÉn Tam Gi√°c - To√°n 7</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(135deg, #a8ff78 0%, #78ffd6 100%);
            min-height: 100vh;
        }
        .title-font {
            font-family: 'Fredoka One', cursive;
        }
        .game-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 2rem;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            border: 6px solid #ffffff;
        }
        .option-btn {
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .option-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .animate-bounce-slow {
            animation: bounce 2s infinite;
        }
    </style>
</head>
<body class="p-4 flex items-center justify-center">

    <div id="game-container" class="max-w-3xl w-full game-card p-6 md:p-10 relative overflow-hidden">
        
        <!-- M√†n h√¨nh ch√†o m·ª´ng -->
        <div id="start-screen" class="text-center">
            <div class="text-7xl mb-6 animate-bounce-slow">üìê</div>
            <h1 class="text-4xl md:text-6xl title-font text-emerald-600 mb-4 drop-shadow-sm">TH·ª¢ SƒÇN<br>TAM GI√ÅC</h1>
            <p class="text-gray-600 text-lg mb-8 font-semibold">Ch√†o m·ª´ng c√°c em ƒë·∫øn v·ªõi l·ªõp h·ªçc c·ªßa c√¥ <b>Thu B√¨nh</b>!<br>C√°c em ƒë√£ s·∫µn s√†ng truy t√¨m c√°c g√≥c ·∫©n gi·∫•u ch∆∞a?</p>
            <button onclick="startGame()" class="bg-gradient-to-r from-emerald-500 to-teal-500 text-white font-bold py-4 px-12 rounded-full text-2xl shadow-lg hover:scale-110 transition-transform">
                B·∫ÆT ƒê·∫¶U NGAY! üöÄ
            </button>
        </div>

        <!-- M√†n h√¨nh c√¢u h·ªèi -->
        <div id="quiz-screen" class="hidden">
            <div class="flex justify-between items-center mb-6">
                <div class="bg-emerald-100 text-emerald-700 px-4 py-2 rounded-2xl font-bold">
                    C√¢u: <span id="q-current">1</span>/15
                </div>
                <div class="bg-amber-100 text-amber-700 px-4 py-2 rounded-2xl font-bold">
                    ƒêi·ªÉm: <span id="score">0</span>
                </div>
            </div>

            <div class="w-full bg-gray-200 rounded-full h-3 mb-8">
                <div id="progress" class="bg-emerald-500 h-3 rounded-full transition-all duration-500" style="width: 0%"></div>
            </div>

            <div id="question-area" class="mb-10">
                <div id="level-tag" class="text-xs font-bold uppercase tracking-widest text-emerald-400 mb-2"></div>
                <h2 id="question-text" class="text-xl md:text-2xl font-bold text-gray-800 leading-relaxed"></h2>
            </div>

            <div id="options-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- ƒê√°p √°n s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y -->
            </div>
        </div>

        <!-- Modal Ph·∫£n h·ªìi -->
        <div id="feedback-modal" class="hidden fixed inset-0 flex items-center justify-center z-50 p-4">
            <div class="absolute inset-0 bg-emerald-900/40 backdrop-blur-sm"></div>
            <div class="bg-white rounded-[2.5rem] p-8 max-w-md w-full relative shadow-2xl text-center">
                <div id="fb-icon" class="text-6xl mb-4"></div>
                <h3 id="fb-title" class="text-3xl font-bold mb-4"></h3>
                <div class="bg-emerald-50 p-4 rounded-2xl mb-6 text-left border-l-4 border-emerald-500">
                    <p id="fb-rationale" class="text-gray-700 text-sm italic leading-relaxed"></p>
                </div>
                <button onclick="nextStep()" class="w-full bg-emerald-500 text-white font-bold py-4 rounded-2xl hover:bg-emerald-600 transition-colors shadow-lg">
                    TI·∫æP T·ª§C ‚ûî
                </button>
            </div>
        </div>

        <!-- M√†n h√¨nh k·∫øt th√∫c -->
        <div id="end-screen" class="hidden text-center">
            <div class="text-8xl mb-6">üëë</div>
            <h2 class="text-4xl font-bold text-emerald-600 mb-2">HO√ÄN TH√ÄNH!</h2>
            <p class="text-xl text-gray-600 mb-8 font-semibold">Tuy·ªát v·ªùi! Em ƒë√£ ghi ƒë∆∞·ª£c: <span id="final-score" class="text-emerald-500 text-3xl font-black">0</span>/15 ƒëi·ªÉm</p>
            <div id="rank-msg" class="text-gray-500 mb-10 italic"></div>
            <button onclick="location.reload()" class="bg-gray-800 text-white font-bold py-4 px-10 rounded-2xl hover:bg-black transition-colors shadow-lg">
                CH∆†I L·∫†I N√à üîÑ
            </button>
        </div>
    </div>

   <script>
/* ================== TI·ªÜN √çCH RANDOM ================== */
function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

/* ================== √ÇM THANH ================== */
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
function playTone(freq, type, dur) {
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.type = type;
    osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
    gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + dur);
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.start();
    osc.stop(audioCtx.currentTime + dur);
}
        const questions = [
            // NH·∫¨N BI·∫æT (6 c√¢u)
            {
                lvl: "Nh·∫≠n bi·∫øt",
                q: "T·ªïng s·ªë ƒëo ba g√≥c trong m·ªôt tam gi√°c b·∫•t k√¨ b·∫±ng bao nhi√™u?",
                opts: ["90¬∞", "180¬∞", "270¬∞", "360¬∞"],
                ans: 1,
                rat: "ƒê·ªãnh l√≠: T·ªïng ba g√≥c c·ªßa m·ªôt tam gi√°c b·∫±ng $180^\\circ$."
            },
            {
                lvl: "Nh·∫≠n bi·∫øt",
                q: "Tam gi√°c c√≥ m·ªôt g√≥c vu√¥ng ƒë∆∞·ª£c g·ªçi l√†:",
                opts: ["Tam gi√°c nh·ªçn", "Tam gi√°c t√π", "Tam gi√°c vu√¥ng", "Tam gi√°c c√¢n"],
                ans: 2,
                rat: "Tam gi√°c c√≥ m·ªôt g√≥c b·∫±ng $90^\\circ$ g·ªçi l√† tam gi√°c vu√¥ng."
            },
            {
                lvl: "Nh·∫≠n bi·∫øt",
                q: "Trong m·ªôt tam gi√°c vu√¥ng, t·ªïng hai g√≥c nh·ªçn b·∫±ng:",
                opts: ["45¬∞", "90¬∞", "180¬∞", "60¬∞"],
                ans: 1,
                rat: "V√¨ t·ªïng 3 g√≥c l√† $180^\\circ$, g√≥c vu√¥ng l√† $90^\\circ$, n√™n 2 g√≥c c√≤n l·∫°i c√≥ t·ªïng l√† $180 - 90 = 90^\\circ$."
            },
            {
                lvl: "Nh·∫≠n bi·∫øt",
                q: "Tam gi√°c nh·ªçn l√† tam gi√°c c√≥:",
                opts: ["C√≥ m·ªôt g√≥c nh·ªçn", "C√≥ hai g√≥c nh·ªçn", "C·∫£ ba g√≥c ƒë·ªÅu nh·ªçn", "C√≥ g√≥c l·ªõn nh·∫•t b·∫±ng 90¬∞"],
                ans: 2,
                rat: "ƒê·ªãnh nghƒ©a: Tam gi√°c nh·ªçn l√† tam gi√°c c√≥ c·∫£ ba g√≥c ƒë·ªÅu l√† g√≥c nh·ªçn (nh·ªè h∆°n $90^\\circ$)."
            },
            {
                lvl: "Nh·∫≠n bi·∫øt",
                q: "M·ªôt tam gi√°c c√≥ th·ªÉ c√≥ t·ªëi ƒëa bao nhi√™u g√≥c t√π?",
                opts: ["1 g√≥c", "2 g√≥c", "3 g√≥c", "Kh√¥ng c√≥ g√≥c n√†o"],
                ans: 0,
                rat: "N·∫øu c√≥ 2 g√≥c t√π (m·ªói g√≥c > $90^\\circ$), t·ªïng 2 g√≥c ƒë√£ l·ªõn h∆°n $180^\\circ$, vi ph·∫°m ƒë·ªãnh l√≠ t·ªïng 3 g√≥c."
            },
            {
                lvl: "Nh·∫≠n bi·∫øt",
                q: "Cho $\\triangle ABC$ c√≥ $\\hat{A} = 50^\\circ, \\hat{B} = 70^\\circ$. S·ªë ƒëo g√≥c $C$ l√†:",
                opts: ["50¬∞", "60¬∞", "70¬∞", "180¬∞"],
                ans: 1,
                rat: "$\\hat{C} = 180^\\circ - (50^\\circ + 70^\\circ) = 180^\\circ - 120^\\circ = 60^\\circ$."
            },
            // TH√îNG HI·ªÇU (5 c√¢u)
            {
                lvl: "Th√¥ng hi·ªÉu",
                q: "Cho $\\triangle ABC$ vu√¥ng t·∫°i $A$. N·∫øu $\\hat{B} = 40^\\circ$ th√¨ $\\hat{C}$ b·∫±ng:",
                opts: ["40¬∞", "50¬∞", "90¬∞", "140¬∞"],
                ans: 1,
                rat: "Trong tam gi√°c vu√¥ng, 2 g√≥c nh·ªçn ph·ª• nhau: $\\hat{C} = 90^\\circ - 40^\\circ = 50^\\circ$."
            },
            {
                lvl: "Th√¥ng hi·ªÉu",
                q: "Cho $\\triangle MNP$ c√≥ $\\hat{M} = 100^\\circ$ v√† $\\hat{N} = \\hat{P}$. S·ªë ƒëo g√≥c $N$ l√†:",
                opts: ["40¬∞", "80¬∞", "100¬∞", "50¬∞"],
                ans: 0,
                rat: "$\\hat{N} + \\hat{P} = 180^\\circ - 100^\\circ = 80^\\circ$. V√¨ $\\hat{N} = \\hat{P}$ n√™n $\\hat{N} = 80^\\circ : 2 = 40^\\circ$."
            },
            {
                lvl: "Th√¥ng hi·ªÉu",
                q: "M·ªôt tam gi√°c c√≥ ba g√≥c b·∫±ng nhau. S·ªë ƒëo m·ªói g√≥c l√†:",
                opts: ["45¬∞", "60¬∞", "90¬∞", "180¬∞"],
                ans: 1,
                rat: "T·ªïng 3 g√≥c l√† $180^\\circ$, n·∫øu 3 g√≥c b·∫±ng nhau th√¨ m·ªói g√≥c b·∫±ng $180^\\circ : 3 = 60^\\circ$."
            },
            {
                lvl: "Th√¥ng hi·ªÉu",
                q: "Cho $\\triangle ABC$ c√≥ $\\hat{A} : \\hat{B} : \\hat{C} = 1 : 2 : 3$. ƒê√¢y l√† tam gi√°c g√¨?",
                opts: ["Tam gi√°c nh·ªçn", "Tam gi√°c vu√¥ng", "Tam gi√°c t√π", "Tam gi√°c c√¢n"],
                ans: 1,
                rat: "T·ªïng s·ªë ph·∫ßn: $1+2+3=6$. M·ªôt ph·∫ßn l√† $180:6=30^\\circ$. G√≥c l·ªõn nh·∫•t l√† $30 \\cdot 3 = 90^\\circ$. V·∫≠y l√† tam gi√°c vu√¥ng."
            },
            {
                lvl: "Th√¥ng hi·ªÉu",
                q: "Cho $\\triangle ABC$ vu√¥ng t·∫°i $A$ c√≥ $\\hat{B} = 2\\hat{C}$. S·ªë ƒëo g√≥c $B$ l√†:",
                opts: ["30¬∞", "60¬∞", "45¬∞", "20¬∞"],
                ans: 1,
                rat: "$\\hat{B} + \\hat{C} = 90^\\circ$. Thay $\\hat{B} = 2\\hat{C}$ v√†o ta c√≥ $3\\hat{C} = 90^\\circ \\implies \\hat{C} = 30^\\circ, \\hat{B} = 60^\\circ$."
            },
            // V·∫¨N D·ª§NG (3 c√¢u)
            {
                lvl: "V·∫≠n d·ª•ng",
                q: "Cho $\\triangle ABC$ c√≥ $\\hat{A} = 70^\\circ$. Tia ph√¢n gi√°c c·ªßa g√≥c $B$ v√† g√≥c $C$ c·∫Øt nhau t·∫°i $I$. T√≠nh s·ªë ƒëo g√≥c $BIC$.",
                opts: ["110¬∞", "125¬∞", "140¬∞", "100¬∞"],
                ans: 1,
                rat: "$\\hat{B} + \\hat{C} = 110^\\circ \\implies \\hat{B}/2 + \\hat{C}/2 = 55^\\circ$. Trong $\\triangle BIC$: $\\hat{BIC} = 180^\\circ - 55^\\circ = 125^\\circ$."
            },
            {
                lvl: "V·∫≠n d·ª•ng",
                q: "(Th·ª±c t·∫ø) M·ªôt c√°i thang d·ª±a v√†o t∆∞·ªùng t·∫°o th√†nh m·ªôt tam gi√°c vu√¥ng. N·∫øu g√≥c t·∫°o b·ªüi c√°i thang v√† m·∫∑t ƒë·∫•t l√† $65^\\circ$ th√¨ g√≥c t·∫°o b·ªüi c√°i thang v√† b·ª©c t∆∞·ªùng l√†:",
                opts: ["25¬∞", "35¬∞", "65¬∞", "90¬∞"],
                ans: 0,
                rat: "Thang, t∆∞·ªùng v√† ƒë·∫•t t·∫°o th√†nh tam gi√°c vu√¥ng. G√≥c c·∫ßn t√¨m l√† g√≥c nh·ªçn c√≤n l·∫°i: $90^\\circ - 65^\\circ = 25^\\circ$."
            },
            {
                lvl: "V·∫≠n d·ª•ng",
                q: "Cho $\\triangle ABC$, g√≥c ngo√†i t·∫°i ƒë·ªânh $C$ b·∫±ng $120^\\circ$ v√† $\\hat{A} = 50^\\circ$. S·ªë ƒëo g√≥c $B$ l√†:",
                opts: ["50¬∞", "70¬∞", "60¬∞", "120¬∞"],
                ans: 1,
                rat: "G√≥c ngo√†i b·∫±ng t·ªïng hai g√≥c trong kh√¥ng k·ªÅ v·ªõi n√≥: $120^\\circ = \\hat{A} + \\hat{B} \\implies \\hat{B} = 120^\\circ - 50^\\circ = 70^\\circ$."
            },
            // V·∫¨N D·ª§NG CAO (1 c√¢u)
            {
                lvl: "V·∫≠n d·ª•ng cao",
                q: "Cho $\\triangle ABC$ c√≥ $\\hat{B} - \\hat{C} = 20^\\circ$. Tia ph√¢n gi√°c c·ªßa g√≥c $A$ c·∫Øt $BC$ t·∫°i $D$. T√≠nh s·ªë ƒëo g√≥c $ADC$.",
                opts: ["80¬∞", "100¬∞", "90¬∞", "110¬∞"],
                ans: 1,
                rat: "$\\hat{ADC} = \\hat{B} + \\hat{A}/2 = \\hat{B} + (180-\\hat{B}-\\hat{C})/2 = (2\\hat{B} + 180 - \\hat{B} - \\hat{C})/2 = (180 + \\hat{B} - \\hat{C})/2 = (180+20)/2 = 100^\\circ$."
            }
        ];

      /* ================== RANDOM C√ÇU H·ªéI ================== */
shuffle(questions);

/* ================== BI·∫æN TR·∫†NG TH√ÅI ================== */
let currentIdx = 0;
let score = 0;
let currentOptions = [];

/* ================== B·∫ÆT ƒê·∫¶U GAME ================== */
function startGame() {
    document.getElementById('start-screen').classList.add('hidden');
    document.getElementById('quiz-screen').classList.remove('hidden');
    showQuestion();
}

/* ================== HI·ªÇN TH·ªä C√ÇU H·ªéI ================== */
function showQuestion() {
    const q = questions[currentIdx];

    document.getElementById('q-current').innerText = currentIdx + 1;
    document.getElementById('score').innerText = score;
    document.getElementById('level-tag').innerText = `M·ª©c ƒë·ªô: ${q.lvl}`;
    document.getElementById('question-text').innerHTML = q.q;
    document.getElementById('progress').style.width =
        `${(currentIdx / questions.length) * 100}%`;

    /* Chu·∫©n ho√° & random ƒë√°p √°n */
    currentOptions = q.opts.map((text, idx) => ({
        text,
        isCorrect: idx === q.ans
    }));
    shuffle(currentOptions);

    const container = document.getElementById('options-container');
    container.innerHTML = "";

    currentOptions.forEach((opt, i) => {
        const btn = document.createElement('button');
        btn.className =
            "option-btn bg-white border-2 border-emerald-100 p-4 rounded-2xl text-left hover:border-emerald-400 hover:bg-emerald-50 text-gray-700 font-bold shadow-sm";
        btn.innerHTML = `<b>${String.fromCharCode(65 + i)}.</b> ${opt.text}`;
        btn.onclick = () => checkAnswer(i);
        container.appendChild(btn);
    });
}

/* ================== KI·ªÇM TRA ƒê√ÅP √ÅN ================== */
function checkAnswer(i) {
    const q = questions[currentIdx];
    const isCorrect = currentOptions[i].isCorrect;

    if (isCorrect) {
        score++;
        playTone(600, 'sine', 0.2);
        confetti({ particleCount: 120, spread: 70, origin: { y: 0.6 } });
        fb("üòá", "Qu√° gi·ªèi lu√¥n!", "emerald");
    } else {
        playTone(150, 'sawtooth', 0.3);
        fb("ü•∫", "C·ªë l√™n nha!", "red");
    }

    document.getElementById('fb-rationale').innerHTML =
        `<b>Gi·∫£i th√≠ch:</b> ${q.rat}`;
    document.getElementById('feedback-modal').classList.remove('hidden');
}

function fb(icon, text, color) {
    document.getElementById('fb-icon').innerText = icon;
    document.getElementById('fb-title').innerText = text;
    document.getElementById('fb-title').className =
        `text-3xl font-bold mb-4 text-${color}-500`;
}

/* ================== CHUY·ªÇN C√ÇU ================== */
function nextStep() {
    document.getElementById('feedback-modal').classList.add('hidden');
    currentIdx++;
    currentIdx < questions.length ? showQuestion() : showEnd();
}

/* ================== K·∫æT TH√öC ================== */
function showEnd() {
    document.getElementById('quiz-screen').classList.add('hidden');
    document.getElementById('end-screen').classList.remove('hidden');
    document.getElementById('final-score').innerText = score;

    let msg =
        score === 15 ? "ƒê·ªânh c·ªßa ch√≥p! üèÜ" :
        score >= 12 ? "R·∫•t xu·∫•t s·∫Øc! ‚ú®" :
        score >= 8  ? "Kh√° t·ªët! üí™" :
                      "√în l·∫°i v√† th·ª≠ l·∫°i nh√© ‚ù§Ô∏è";

    document.getElementById('rank-msg').innerText = msg;
    confetti({ particleCount: 250, spread: 160, origin: { y: 0.6 } });
}
</script>
</body>
</html>
