<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kh√°m Ph√° Th·∫ø Gi·ªõi T·ª© Gi√°c (To√°n 8)</title>
    <!-- T·∫£i Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* T√πy ch·ªânh font cho ti·∫øng Vi·ªát */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .quiz-container {
            max-width: 900px;
        }
        .option-button {
            transition: all 0.2s;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }
        .option-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
        }
        .correct-answer {
            background-color: #4ade80 !important; /* green-400 */
            color: #166534 !important; /* green-800 */
            border-color: #16a34a !important; /* green-600 */
        }
        .incorrect-answer {
            background-color: #fca5a5 !important; /* red-300 */
            color: #b91c1c !important; /* red-700 */
            border-color: #ef4444 !important; /* red-500 */
        }
        /* Hi·ªáu ·ª©ng ph√°o hoa - Confetti */
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: transparent;
            border-radius: 50%;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.5s;
        }
        .confetti-visible {
            opacity: 1;
            transition: none;
        }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen flex items-center justify-center">

    <div id="quiz-app" class="quiz-container w-full bg-white p-6 md:p-10 rounded-xl shadow-2xl relative">
        <h1 class="text-3xl font-bold text-center text-red-700 mb-6">Kh√°m Ph√° Th·∫ø Gi·ªõi T·ª© Gi√°c</h1>
        <p id="difficulty-level" class="text-center text-sm font-medium text-gray-500 mb-4"></p>
        
        <!-- Kh·ªüi ƒë·ªông/K·∫øt qu·∫£ -->
        <div id="start-screen" class="text-center">
            <h2 class="text-2xl font-semibold text-gray-800 mb-4">Ch√†o m·ª´ng ƒë·∫øn v·ªõi B√†i 2: T·ª© Gi√°c (To√°n 8)</h2>
            <p class="mb-6 text-gray-600">
                Tr·∫Øc nghi·ªám n√†y g·ªìm <strong>21 c√¢u h·ªèi</strong> ƒë∆∞·ª£c x√¢y d·ª±ng theo 4 m·ª©c ƒë·ªô:
                Nh·∫≠n bi·∫øt, Th√¥ng hi·ªÉu, V·∫≠n d·ª•ng, V·∫≠n d·ª•ng cao.
            </p>
            <p class="mb-8 text-gray-600 font-medium">
                S·ª≠ d·ª•ng ki·∫øn th·ª©c v·ªÅ T·ª© gi√°c l·ªìi ƒë·ªÉ chinh ph·ª•c th·ª≠ th√°ch n√†y nh√©!
            </p>
            <button id="start-button" class="px-8 py-3 bg-red-600 text-white font-semibold rounded-lg shadow-lg hover:bg-red-700 transition duration-300 transform hover:scale-105">
                B·∫Øt ƒê·∫ßu Th·ª≠ Th√°ch
            </button>
        </div>

        <!-- Ph·∫ßn Quiz -->
        <div id="quiz-content" class="hidden">
            <div id="progress-bar" class="w-full bg-gray-200 rounded-full h-2.5 mb-6">
                <div id="progress" class="bg-red-600 h-2.5 rounded-full transition-all duration-500" style="width: 0%"></div>
            </div>

            <div id="question-card" class="bg-red-50 p-6 rounded-xl border-t-4 border-red-500 mb-6">
                <p id="question-text" class="text-xl font-medium text-gray-800 mb-4"></p>
                <div id="answer-options" class="space-y-3">
                    <!-- C√°c n√∫t tr·∫£ l·ªùi s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
                </div>
            </div>

            <!-- Gi·∫£i th√≠ch (Rationale) -->
            <div id="rationale-box" class="hidden p-4 mt-4 rounded-lg bg-blue-100 border-l-4 border-blue-500 text-blue-800">
                <p class="font-semibold">Gi·∫£i th√≠ch:</p>
                <p id="rationale-text" class="mt-1 text-sm"></p>
            </div>

            <!-- N√∫t Ti·∫øp theo -->
            <button id="next-button" class="hidden w-full px-4 py-3 bg-red-600 text-white font-semibold rounded-lg shadow-md hover:bg-red-700 transition duration-300 mt-6">
                C√¢u Ti·∫øp Theo
            </button>
        </div>

        <!-- M√†n h√¨nh k·∫øt qu·∫£ -->
        <div id="result-screen" class="hidden text-center">
            <h2 class="text-3xl font-bold text-red-700 mb-4">Ho√†n Th√†nh Th·ª≠ Th√°ch!</h2>
            <p class="text-5xl font-extrabold text-green-600 mb-6">
                <span id="score-display">0</span>/21
            </p>
            <p id="result-message" class="text-xl text-gray-700 mb-8"></p>
            <button id="restart-button" class="px-8 py-3 bg-green-600 text-white font-semibold rounded-lg shadow-lg hover:bg-green-700 transition duration-300 transform hover:scale-105">
                L√†m L·∫°i
            </button>
        </div>

        <!-- Confetti Emitter -->
        <div id="confetti-emitter"></div>
    </div>
      <script>
    // D·ªØ li·ªáu 21 c√¢u h·ªèi
    const quizQuestions = [
        // --- NH·∫¨N BI·∫æT ---
        {
            level: "Nh·∫≠n bi·∫øt",
            question: "T·ª© gi√°c l√† h√¨nh ƒë∆∞·ª£c t·∫°o th√†nh t·ª´ bao nhi√™u ƒëo·∫°n th·∫≥ng, n·ªëi c√°c ƒëi·ªÉm kh√¥ng th·∫≥ng h√†ng?",
            options: [
                { text: "Hai ƒëo·∫°n th·∫≥ng", isCorrect: false, rationale: "Hai ƒëo·∫°n th·∫≥ng ch·ªâ t·∫°o th√†nh m·ªôt g√≥c ho·∫∑c m·ªôt ph·∫ßn ƒë∆∞·ªùng g·∫•p kh√∫c, ch∆∞a t·∫°o th√†nh m·ªôt h√¨nh k√≠n." },
                { text: "Ba ƒëo·∫°n th·∫≥ng", isCorrect: false, rationale: "Ba ƒëo·∫°n th·∫≥ng n·ªëi l·∫°i t·∫°o th√†nh tam gi√°c." },
                { text: "B·ªën ƒëo·∫°n th·∫≥ng", isCorrect: true, rationale: "T·ª© gi√°c l√† h√¨nh ƒë∆∞·ª£c t·∫°o th√†nh t·ª´ b·ªën ƒëo·∫°n th·∫≥ng, n·ªëi b·ªën ƒëi·ªÉm kh√¥ng th·∫≥ng h√†ng theo th·ª© t·ª±." },
                { text: "NƒÉm ƒëo·∫°n th·∫≥ng", isCorrect: false, rationale: "NƒÉm ƒëo·∫°n th·∫≥ng n·ªëi l·∫°i t·∫°o th√†nh m·ªôt ng≈© gi√°c, kh√¥ng ph·∫£i t·ª© gi√°c." }
            ],
            hint: "T√™n g·ªçi 't·ª© gi√°c' ƒë√£ g·ª£i √Ω v·ªÅ s·ªë l∆∞·ª£ng c·∫°nh v√† ƒë·ªânh."
        },
        {
            level: "Nh·∫≠n bi·∫øt",
            question: "T·ªïng c√°c g√≥c trong m·ªôt t·ª© gi√°c l·ªìi b·∫±ng bao nhi√™u ƒë·ªô?",
            options: [
                { text: "180¬∞", isCorrect: false, rationale: "180¬∞ l√† t·ªïng c√°c g√≥c trong m·ªôt tam gi√°c." },
                { text: "360¬∞", isCorrect: true, rationale: "T·ªïng c√°c g√≥c trong m·ªôt t·ª© gi√°c l·ªìi lu√¥n b·∫±ng 360¬∞." },
                { text: "270¬∞", isCorrect: false, rationale: "Gi√° tr·ªã n√†y kh√¥ng ph·∫£i t·ªïng g√≥c trong c·ªßa t·ª© gi√°c." },
                { text: "90¬∞", isCorrect: false, rationale: "90¬∞ l√† s·ªë ƒëo m·ªôt g√≥c vu√¥ng." }
            ],
            hint: "H√£y nh·ªõ: t·ª© gi√°c c√≥ th·ªÉ chia th√†nh hai tam gi√°c."
        },
        {
            level: "Nh·∫≠n bi·∫øt",
            question: "Trong t·ª© gi√°c ABCD, g√≥c ƒë·ªëi di·ªán v·ªõi ƒë·ªânh A l√† g√≥c n√†o?",
            options: [
                { text: "G√≥c B", isCorrect: false, rationale: "G√≥c B l√† g√≥c k·ªÅ v·ªõi g√≥c A." },
                { text: "G√≥c C", isCorrect: true, rationale: "G√≥c C n·∫±m ƒë·ªëi di·ªán v·ªõi g√≥c A, kh√¥ng chung c·∫°nh v·ªõi A." },
                { text: "G√≥c D", isCorrect: false, rationale: "G√≥c D l√† g√≥c k·ªÅ v·ªõi g√≥c A." },
                { text: "C·∫£ g√≥c B v√† g√≥c D", isCorrect: false, rationale: "Ch·ªâ c√≥ m·ªôt g√≥c ƒë·ªëi di·ªán v·ªõi A l√† g√≥c C." }
            ],
            hint: "G√≥c ƒë·ªëi di·ªán l√† g√≥c kh√¥ng c√≥ c·∫°nh chung v·ªõi g√≥c ƒëang x√©t."
        },
        {
            level: "Nh·∫≠n bi·∫øt",
            question: "Cho t·ª© gi√°c EFGH. Hai ƒë·ªânh k·ªÅ nhau l√†:",
            options: [
                { text: "E v√† G", isCorrect: false, rationale: "E v√† G l√† hai ƒë·ªânh ƒë·ªëi di·ªán, kh√¥ng k·ªÅ nhau." },
                { text: "F v√† H", isCorrect: false, rationale: "F v√† H c≈©ng l√† hai ƒë·ªânh ƒë·ªëi di·ªán." },
                { text: "E v√† F", isCorrect: true, rationale: "E v√† F l√† hai ƒë·ªânh c√πng n·∫±m tr√™n c·∫°nh EF n√™n l√† hai ƒë·ªânh k·ªÅ nhau." },
                { text: "E, F, G, H", isCorrect: false, rationale: "ƒê√¢y l√† to√†n b·ªô c√°c ƒë·ªânh c·ªßa t·ª© gi√°c." }
            ],
            hint: "Hai ƒë·ªânh k·ªÅ nhau l√† hai ƒë·ªânh c√πng n·∫±m tr√™n m·ªôt c·∫°nh."
        },
        {
            level: "Nh·∫≠n bi·∫øt",
            question: "ƒê∆∞·ªùng ch√©o c·ªßa t·ª© gi√°c MNPQ l√† ƒëo·∫°n th·∫≥ng n√†o?",
            options: [
                { text: "MN", isCorrect: false, rationale: "MN l√† m·ªôt c·∫°nh c·ªßa t·ª© gi√°c." },
                { text: "MQ", isCorrect: false, rationale: "MQ l√† m·ªôt c·∫°nh c·ªßa t·ª© gi√°c." },
                { text: "MP", isCorrect: true, rationale: "ƒê∆∞·ªùng ch√©o n·ªëi hai ƒë·ªânh ƒë·ªëi di·ªán, v√≠ d·ª• nh∆∞ MP ho·∫∑c NQ." },
                { text: "NP", isCorrect: false, rationale: "NP l√† m·ªôt c·∫°nh c·ªßa t·ª© gi√°c." }
            ],
            hint: "ƒê∆∞·ªùng ch√©o l√† ƒëo·∫°n th·∫≥ng n·ªëi hai ƒë·ªânh kh√¥ng k·ªÅ nhau."
        },
        {
            level: "Nh·∫≠n bi·∫øt",
            question: "T·ª© gi√°c l·ªìi l√† t·ª© gi√°c m√†:",
            options: [
                { text: "C√°c c·∫°nh b·∫±ng nhau.", isCorrect: false, rationale: "ƒê√¢y l√† t√≠nh ch·∫•t c·ªßa m·ªôt s·ªë t·ª© gi√°c ƒë·∫∑c bi·ªát nh∆∞ h√¨nh thoi, h√¨nh vu√¥ng." },
                { text: "T·∫•t c·∫£ c√°c g√≥c ƒë·ªÅu nh·ªçn.", isCorrect: false, rationale: "Kh√¥ng nh·∫•t thi·∫øt t·∫•t c·∫£ c√°c g√≥c ƒë·ªÅu nh·ªçn, nh∆∞ng t·ªïng b·ªën g√≥c v·∫´n l√† 360¬∞." },
                { text: "N·∫±m ho√†n to√†n v·ªÅ m·ªôt ph√≠a c·ªßa ƒë∆∞·ªùng th·∫≥ng ch·ª©a b·∫•t k·ª≥ c·∫°nh n√†o c·ªßa n√≥.", isCorrect: true, rationale: "ƒê√¢y l√† ƒë·ªãnh nghƒ©a chu·∫©n c·ªßa t·ª© gi√°c l·ªìi trong s√°ch gi√°o khoa." },
                { text: "Ch·ªâ c√≥ hai ƒë∆∞·ªùng ch√©o b·∫±ng nhau.", isCorrect: false, rationale: "Hai ƒë∆∞·ªùng ch√©o b·∫±ng nhau l√† t√≠nh ch·∫•t c·ªßa h√¨nh ch·ªØ nh·∫≠t." }
            ],
            hint: "H√£y nh·ªõ m·ªëi quan h·ªá gi·ªØa c√°c c·∫°nh, c√°c ƒë·ªânh v√† ph·∫ßn b√™n trong t·ª© gi√°c l·ªìi."
        },

        // --- TH√îNG HI·ªÇU ---
        {
            level: "Th√¥ng hi·ªÉu",
            question: "Cho t·ª© gi√°c ABCD c√≥ g√≥c A = 75¬∞, g√≥c B = 100¬∞, g√≥c C = 85¬∞. T√≠nh s·ªë ƒëo g√≥c D.",
            options: [
                { text: "100¬∞", isCorrect: true, rationale: "T·ªïng b·ªën g√≥c t·ª© gi√°c b·∫±ng 360¬∞. V·∫≠y g√≥c D = 360¬∞ - (75¬∞ + 100¬∞ + 85¬∞) = 360¬∞ - 260¬∞ = 100¬∞." },
                { text: "90¬∞", isCorrect: false, rationale: "90¬∞ l√† kho·∫£ng ch√™nh l·ªách n·∫øu c·ªông nh·∫ßm c√°c g√≥c." },
                { text: "85¬∞", isCorrect: false, rationale: "85¬∞ l√† s·ªë ƒëo g√≥c C, kh√¥ng ph·∫£i g√≥c D." },
                { text: "75¬∞", isCorrect: false, rationale: "75¬∞ l√† s·ªë ƒëo g√≥c A." }
            ],
            hint: "T·ªïng c√°c g√≥c trong m·ªôt t·ª© gi√°c l√† 360¬∞."
        },
        {
            level: "Th√¥ng hi·ªÉu",
            question: "M·ªôt t·ª© gi√°c c√≥ ba g√≥c l·∫ßn l∆∞·ª£t l√† 90¬∞, 110¬∞ v√† 70¬∞. H·ªèi g√≥c c√≤n l·∫°i l√† lo·∫°i g√≥c g√¨?",
            options: [
                { text: "G√≥c nh·ªçn", isCorrect: false, rationale: "G√≥c nh·ªçn c√≥ s·ªë ƒëo nh·ªè h∆°n 90¬∞." },
                { text: "G√≥c vu√¥ng", isCorrect: true, rationale: "G√≥c c√≤n l·∫°i b·∫±ng 360¬∞ - (90¬∞ + 110¬∞ + 70¬∞) = 360¬∞ - 270¬∞ = 90¬∞. ƒê√≥ l√† g√≥c vu√¥ng." },
                { text: "G√≥c t√π", isCorrect: false, rationale: "G√≥c t√π c√≥ s·ªë ƒëo l·ªõn h∆°n 90¬∞ nh∆∞ng nh·ªè h∆°n 180¬∞." },
                { text: "G√≥c b·∫πt", isCorrect: false, rationale: "G√≥c b·∫πt c√≥ s·ªë ƒëo b·∫±ng 180¬∞." }
            ],
            hint: "T√≠nh s·ªë ƒëo g√≥c c√≤n l·∫°i r·ªìi so s√°nh v·ªõi 90¬∞."
        },
        {
            level: "Th√¥ng hi·ªÉu",
            question: "Trong m·ªôt t·ª© gi√°c, n·∫øu hai g√≥c k·ªÅ nhau c√≥ t·ªïng b·∫±ng 180¬∞, th√¨ hai c·∫°nh ƒë·ªëi c√≤n l·∫°i c√≥ m·ªëi quan h·ªá g√¨?",
            options: [
                { text: "Ch√∫ng vu√¥ng g√≥c v·ªõi nhau.", isCorrect: false, rationale: "Hai g√≥c k·ªÅ b√π nhau kh√¥ng cho ta k·∫øt lu·∫≠n hai c·∫°nh ƒë·ªëi vu√¥ng g√≥c." },
                { text: "Ch√∫ng b·∫±ng nhau.", isCorrect: false, rationale: "Kh√¥ng th·ªÉ k·∫øt lu·∫≠n hai c·∫°nh ƒë·ªëi b·∫±ng nhau ch·ªâ t·ª´ ƒëi·ªÅu ki·ªán hai g√≥c k·ªÅ b√π nhau." },
                { text: "Ch√∫ng song song v·ªõi nhau.", isCorrect: true, rationale: "Trong m·ªôt s·ªë d·∫°ng t·ª© gi√°c (nh∆∞ h√¨nh thang), n·∫øu hai g√≥c k·ªÅ c√≥ t·ªïng 180¬∞ th√¨ hai c·∫°nh ƒë·ªëi c√≤n l·∫°i song song." },
                { text: "Ch√∫ng t·∫°o th√†nh m·ªôt g√≥c t√π.", isCorrect: false, rationale: "Kh√¥ng th·ªÉ k·∫øt lu·∫≠n nh∆∞ v·∫≠y t·ª´ t·ªïng hai g√≥c k·ªÅ." }
            ],
            hint: "H√£y nh·ªõ d·∫•u hi·ªáu nh·∫≠n bi·∫øt h√¨nh thang: m·ªôt c·∫∑p c·∫°nh ƒë·ªëi song song khi hai g√≥c c√πng ph√≠a trong k·ªÅ nhau b√π nhau."
        },
        {
            level: "Th√¥ng hi·ªÉu",
            question: "S·ªë ƒëo c√°c g√≥c c·ªßa t·ª© gi√°c ABCD t·ªâ l·ªá v·ªõi 1 : 2 : 3 : 4. T√≠nh s·ªë ƒëo g√≥c l·ªõn nh·∫•t.",
            options: [
                { text: "144¬∞", isCorrect: true, rationale: "T·ªïng ph·∫ßn t·ªâ l·ªá l√† 1 + 2 + 3 + 4 = 10. T·ªïng g√≥c l√† 360¬∞. M·ªôt ph·∫ßn l√† 360¬∞ : 10 = 36¬∞. G√≥c l·ªõn nh·∫•t ·ª©ng v·ªõi 4 ph·∫ßn n√™n b·∫±ng 4 √ó 36¬∞ = 144¬∞." },
                { text: "108¬∞", isCorrect: false, rationale: "108¬∞ l√† g√≥c c√≥ 3 ph·∫ßn t·ªâ l·ªá, kh√¥ng ph·∫£i l·ªõn nh·∫•t." },
                { text: "72¬∞", isCorrect: false, rationale: "72¬∞ l√† g√≥c c√≥ 2 ph·∫ßn t·ªâ l·ªá." },
                { text: "36¬∞", isCorrect: false, rationale: "36¬∞ l√† g√≥c nh·ªè nh·∫•t, ·ª©ng v·ªõi 1 ph·∫ßn." }
            ],
            hint: "Chia ƒë·ªÅu t·ªïng 360¬∞ theo t·ªïng s·ªë ph·∫ßn t·ªâ l·ªá."
        },
        {
            level: "Th√¥ng hi·ªÉu",
            question: "Cho t·ª© gi√°c ABCD c√≥ g√≥c A = 60¬∞, g√≥c B = 100¬∞ v√† g√≥c C = 2 l·∫ßn g√≥c D. T√≠nh s·ªë ƒëo g√≥c D.",
            options: [
                { text: "60¬∞", isCorrect: false, rationale: "N·∫øu D = 60¬∞ th√¨ C = 120¬∞, t·ªïng c√°c g√≥c s·∫Ω sai n·∫øu t√≠nh kh√¥ng ƒë√∫ng." },
                { text: "120¬∞", isCorrect: false, rationale: "120¬∞ l√† s·ªë ƒëo c·ªßa g√≥c C n·∫øu D = 60¬∞, kh√¥ng ph·∫£i s·ªë ƒëo c·ªßa g√≥c D." },
                { text: "100¬∞", isCorrect: false, rationale: "Gi√° tr·ªã n√†y kh√¥ng th·ªèa m√£n ph∆∞∆°ng tr√¨nh t·ªïng b·ªën g√≥c." },
                { text: "66,67¬∞ (x·∫•p x·ªâ)", isCorrect: true, rationale: "ƒê·∫∑t g√≥c D = x, khi ƒë√≥ C = 2x. T·ªïng g√≥c: 60¬∞ + 100¬∞ + 2x + x = 360¬∞. Suy ra 3x = 200¬∞, x ‚âà 66,67¬∞." }
            ],
            hint: "ƒê·∫∑t g√≥c D l√† x r·ªìi l·∫≠p ph∆∞∆°ng tr√¨nh t·ªïng b·ªën g√≥c b·∫±ng 360¬∞."
        },

        // --- V·∫¨N D·ª§NG ---
        {
            level: "V·∫≠n d·ª•ng",
            question: "M·ªôt m·∫£nh ƒë·∫•t h√¨nh t·ª© gi√°c c√≥ chu vi 100 m. Bi·∫øt ƒë·ªô d√†i ba c·∫°nh l·∫ßn l∆∞·ª£t l√† 20 m, 30 m v√† 25 m. T√≠nh ƒë·ªô d√†i c·∫°nh c√≤n l·∫°i.",
            options: [
                { text: "25 m", isCorrect: true, rationale: "Chu vi C = a + b + c + d. C·∫°nh c√≤n l·∫°i d = 100 - (20 + 30 + 25) = 100 - 75 = 25 m." },
                { text: "15 m", isCorrect: false, rationale: "15 m l√† k·∫øt qu·∫£ t√≠nh sai do nh·∫ßm l·∫´n khi tr·ª´." },
                { text: "35 m", isCorrect: false, rationale: "35 m kh√¥ng th·ªèa m√£n ƒëi·ªÅu ki·ªán chu vi." },
                { text: "40 m", isCorrect: false, rationale: "40 m l√† k·∫øt qu·∫£ c·ªßa m·ªôt ph√©p tr·ª´ sai." }
            ],
            hint: "Chu vi l√† t·ªïng ƒë·ªô d√†i b·ªën c·∫°nh."
        },
        {
            level: "V·∫≠n d·ª•ng",
            question: "Cho t·ª© gi√°c ABCD c√≥ AB = AD v√† CB = CD. G√≥c ABC = 70¬∞ v√† g√≥c ADC = 110¬∞. H·ªèi c√≥ th·ªÉ t√≠nh ch√≠nh x√°c s·ªë ƒëo g√≥c A ƒë∆∞·ª£c kh√¥ng?",
            options: [
                { text: "C√≥, g√≥c A = 90¬∞", isCorrect: false, rationale: "Ch∆∞a ƒë·ªß d·ªØ ki·ªán ƒë·ªÉ k·∫øt lu·∫≠n g√≥c A = 90¬∞." },
                { text: "C√≥, g√≥c A = 180¬∞", isCorrect: false, rationale: "G√≥c trong t·ª© gi√°c l·ªìi kh√¥ng th·ªÉ b·∫±ng 180¬∞." },
                { text: "C√≥, g√≥c A = 110¬∞", isCorrect: false, rationale: "Gi·∫£ thi·∫øt kh√¥ng cho th·∫•y g√≥c A b·∫±ng g√≥c D." },
                { text: "Kh√¥ng ƒë·ªß d·ªØ ki·ªán ƒë·ªÉ t√≠nh g√≥c A", isCorrect: true, rationale: "Ta ch·ªâ suy ra A + C = 360¬∞ - (70¬∞ + 110¬∞) = 180¬∞, nh∆∞ng kh√¥ng c√≥ quan h·ªá th√™m gi·ªØa A v√† C n√™n kh√¥ng th·ªÉ t√≠nh ri√™ng A." }
            ],
            hint: "D√πng t·ªïng b·ªën g√≥c t·ª© gi√°c ƒë·ªÉ xem c√≥ t√°ch ƒë∆∞·ª£c A ri√™ng kh√¥ng."
        },
        {
            level: "V·∫≠n d·ª•ng (Th·ª±c t·∫ø)",
            question: "M·ªôt c√°nh c·ª≠a s·ªï h√¨nh t·ª© gi√°c c√≥ ba g√≥c l·∫ßn l∆∞·ª£t l√† 90¬∞, 90¬∞ v√† 100¬∞. ƒê·ªÉ c√°nh c·ª≠a s·ªï ƒë√≥ng kh√≠t, g√≥c c√≤n l·∫°i c·ªßa khung c·ª≠a s·ªï ph·∫£i c√≥ s·ªë ƒëo l√† bao nhi√™u?",
            options: [
                { text: "80¬∞", isCorrect: true, rationale: "T·ªïng b·ªën g√≥c trong t·ª© gi√°c l√† 360¬∞. G√≥c c√≤n l·∫°i = 360¬∞ - (90¬∞ + 90¬∞ + 100¬∞) = 360¬∞ - 280¬∞ = 80¬∞." },
                { text: "90¬∞", isCorrect: false, rationale: "N·∫øu g√≥c n√†y l√† 90¬∞, t·ªïng b·ªën g√≥c s·∫Ω l√† 370¬∞." },
                { text: "100¬∞", isCorrect: false, rationale: "N·∫øu g√≥c n√†y l√† 100¬∞, t·ªïng s·∫Ω l√† 380¬∞." },
                { text: "110¬∞", isCorrect: false, rationale: "N·∫øu g√≥c n√†y l√† 110¬∞, t·ªïng s·∫Ω l√† 390¬∞." }
            ],
            hint: "√Åp d·ª•ng quy t·∫Øc t·ªïng b·ªën g√≥c c·ªßa t·ª© gi√°c."
        },

        // --- V·∫¨N D·ª§NG CAO ---
        {
            level: "V·∫≠n d·ª•ng cao",
            question: "Cho t·ª© gi√°c ABCD. C√°c tia ph√¢n gi√°c c·ªßa g√≥c A v√† g√≥c B c·∫Øt nhau t·∫°i I. Bi·∫øt g√≥c C = 120¬∞ v√† g√≥c D = 80¬∞. T√≠nh s·ªë ƒëo g√≥c AIB.",
            options: [
                { text: "80¬∞", isCorrect: false, rationale: "80¬∞ l√† n·ª≠a t·ªïng g√≥c A v√† B, ch∆∞a ph·∫£i s·ªë ƒëo g√≥c AIB." },
                { text: "100¬∞", isCorrect: true, rationale: "Ta c√≥ A + B + C + D = 360¬∞. N√™n A + B = 360¬∞ - (120¬∞ + 80¬∞) = 160¬∞. Trong tam gi√°c AIB, g√≥c AIB = 180¬∞ - (A/2 + B/2) = 180¬∞ - (A + B)/2 = 180¬∞ - 160¬∞/2 = 100¬∞." },
                { text: "110¬∞", isCorrect: false, rationale: "Gi√° tr·ªã l·ªõn h∆°n k·∫øt qu·∫£ ƒë√∫ng." },
                { text: "130¬∞", isCorrect: false, rationale: "Gi√° tr·ªã sai." }
            ],
            hint: "D√πng t·ªïng g√≥c t·ª© gi√°c, r·ªìi √°p d·ª•ng t·ªïng g√≥c tam gi√°c AIB."
        },

        // --- TH√îNG HI·ªÇU (c√≤n l·∫°i) ---
        {
            level: "Th√¥ng hi·ªÉu",
            question: "T·ª© gi√°c ABCD c√≥ g√≥c A = 2x, g√≥c B = 3x, g√≥c C = x, g√≥c D = 4x. T√≠nh s·ªë ƒëo g√≥c B.",
            options: [
                { text: "36¬∞", isCorrect: false, rationale: "36¬∞ l√† s·ªë ƒëo c·ªßa g√≥c C (x)." },
                { text: "72¬∞", isCorrect: false, rationale: "72¬∞ l√† s·ªë ƒëo c·ªßa g√≥c A (2x)." },
                { text: "108¬∞", isCorrect: true, rationale: "T·ªïng g√≥c: 2x + 3x + x + 4x = 10x = 360¬∞. Suy ra x = 36¬∞. G√≥c B = 3x = 108¬∞." },
                { text: "144¬∞", isCorrect: false, rationale: "144¬∞ l√† s·ªë ƒëo c·ªßa g√≥c D (4x)." }
            ],
            hint: "Thi·∫øt l·∫≠p ph∆∞∆°ng tr√¨nh 10x = 360¬∞ ƒë·ªÉ t√¨m x."
        },
        {
            level: "Th√¥ng hi·ªÉu",
            question: "Cho t·ª© gi√°c ABCD. N·∫øu g√≥c A + g√≥c C = 190¬∞, th√¨ g√≥c B + g√≥c D b·∫±ng bao nhi√™u?",
            options: [
                { text: "170¬∞", isCorrect: true, rationale: "T·ªïng b·ªën g√≥c l√† 360¬∞. Do ƒë√≥ B + D = 360¬∞ - (A + C) = 360¬∞ - 190¬∞ = 170¬∞." },
                { text: "190¬∞", isCorrect: false, rationale: "190¬∞ l√† t·ªïng A + C, kh√¥ng ph·∫£i B + D." },
                { text: "200¬∞", isCorrect: false, rationale: "T√≠nh to√°n sai." },
                { text: "180¬∞", isCorrect: false, rationale: "180¬∞ ch·ªâ ƒë√∫ng trong t·ª© gi√°c n·ªôi ti·∫øp khi A v√† C l√† hai g√≥c ƒë·ªëi di·ªán." }
            ],
            hint: "√Åp d·ª•ng c√¥ng th·ª©c t·ªïng b·ªën g√≥c t·ª© gi√°c."
        },
        {
            level: "Th√¥ng hi·ªÉu",
            question: "T·ª© gi√°c c√≥ bao nhi√™u ƒë∆∞·ªùng ch√©o?",
            options: [
                { text: "M·ªôt ƒë∆∞·ªùng ch√©o", isCorrect: false, rationale: "M·ªôt t·ª© gi√°c lu√¥n c√≥ hai ƒë∆∞·ªùng ch√©o." },
                { text: "Hai ƒë∆∞·ªùng ch√©o", isCorrect: true, rationale: "T·ª© gi√°c ABCD c√≥ hai ƒë∆∞·ªùng ch√©o l√† AC v√† BD." },
                { text: "Ba ƒë∆∞·ªùng ch√©o", isCorrect: false, rationale: "Ba ƒë∆∞·ªùng ch√©o l√† c·ªßa ng≈© gi√°c." },
                { text: "B·ªën ƒë∆∞·ªùng ch√©o", isCorrect: false, rationale: "B·ªën l√† s·ªë c·∫°nh c·ªßa t·ª© gi√°c, kh√¥ng ph·∫£i s·ªë ƒë∆∞·ªùng ch√©o." }
            ],
            hint: "H√£y li·ªát k√™ c√°c ƒëo·∫°n n·ªëi hai ƒë·ªânh kh√¥ng k·ªÅ nhau."
        },
        {
            level: "Th√¥ng hi·ªÉu",
            question: "Trong t·ª© gi√°c ABCD, n·∫øu g√≥c A v√† g√≥c B l√† hai g√≥c b√π nhau (t·ªïng b·∫±ng 180¬∞), th√¨ ƒëi·ªÅu g√¨ c√≥ th·ªÉ x·∫£y ra?",
            options: [
                { text: "C·∫°nh AD song song v·ªõi c·∫°nh BC.", isCorrect: false, rationale: "ƒêi·ªÅu n√†y c·∫ßn th√™m ƒëi·ªÅu ki·ªán, kh√¥ng suy ra ch·ªâ t·ª´ A v√† B b√π nhau." },
                { text: "C·∫°nh AB song song v·ªõi c·∫°nh CD.", isCorrect: false, rationale: "Hai g√≥c A v√† B b√π nhau ch∆∞a ƒë·ªß ƒë·ªÉ k·∫øt lu·∫≠n AB song song CD." },
                { text: "C·∫°nh AD v√† c·∫°nh BC kh√¥ng c√≥ m·ªëi quan h·ªá ƒë·∫∑c bi·ªát n√†o suy ra ƒë∆∞·ª£c.", isCorrect: true, rationale: "T·ª´ ƒëi·ªÅu ki·ªán A v√† B b√π nhau, kh√¥ng suy ra ch·∫Øc ch·∫Øn ƒë∆∞·ª£c quan h·ªá ƒë·∫∑c bi·ªát gi·ªØa c√°c c·∫°nh c√≤n l·∫°i." },
                { text: "C·∫£ b·ªën g√≥c ƒë·ªÅu b·∫±ng 90¬∞.", isCorrect: false, rationale: "Khi ƒë√≥ l√† h√¨nh ch·ªØ nh·∫≠t, nh∆∞ng ƒë·ªÅ kh√¥ng cho ƒë·ªß ƒëi·ªÅu ki·ªán." }
            ],
            hint: "Kh√¥ng ph·∫£i m·ªçi ƒëi·ªÅu ki·ªán v·ªÅ g√≥c ƒë·ªÅu cho ta t·ª© gi√°c ƒë·∫∑c bi·ªát."
        },
        {
            level: "Th√¥ng hi·ªÉu",
            question: "S·ªë ƒëo g√≥c ngo√†i t·∫°i m·ªôt ƒë·ªânh c·ªßa t·ª© gi√°c l√† 100¬∞. T√≠nh s·ªë ƒëo g√≥c trong t·∫°i ƒë·ªânh ƒë√≥.",
            options: [
                { text: "80¬∞", isCorrect: true, rationale: "G√≥c trong v√† g√≥c ngo√†i t·∫°i c√πng m·ªôt ƒë·ªânh l√† hai g√≥c k·ªÅ b√π, n√™n t·ªïng b·∫±ng 180¬∞. G√≥c trong = 180¬∞ - 100¬∞ = 80¬∞." },
                { text: "100¬∞", isCorrect: false, rationale: "100¬∞ l√† s·ªë ƒëo g√≥c ngo√†i." },
                { text: "90¬∞", isCorrect: false, rationale: "Ch·ªâ ƒë√∫ng n·∫øu g√≥c ngo√†i l√† 90¬∞." },
                { text: "260¬∞", isCorrect: false, rationale: "260¬∞ kh√¥ng ph·∫£i s·ªë ƒëo g√≥c trong hay ngo√†i trong tr∆∞·ªùng h·ª£p n√†y." }
            ],
            hint: "Hai g√≥c k·ªÅ b√π c√≥ t·ªïng 180¬∞."
        },

        // --- NH·∫¨N BI·∫æT (c√≤n l·∫°i) ---
        {
            level: "Nh·∫≠n bi·∫øt",
            question: "Cho t·ª© gi√°c IJKL. C·∫∑p c·∫°nh ƒë·ªëi nhau l√†:",
            options: [
                { text: "IJ v√† JK", isCorrect: false, rationale: "IJ v√† JK l√† hai c·∫°nh k·ªÅ nhau, chung ƒë·ªânh J." },
                { text: "KL v√† LI", isCorrect: false, rationale: "KL v√† LI l√† hai c·∫°nh k·ªÅ nhau, chung ƒë·ªânh L." },
                { text: "IJ v√† IL", isCorrect: false, rationale: "IJ v√† IL l√† hai c·∫°nh k·ªÅ nhau, chung ƒë·ªânh I." },
                { text: "IJ v√† LK", isCorrect: true, rationale: "Hai c·∫°nh ƒë·ªëi nhau l√† hai c·∫°nh kh√¥ng c√≥ ƒëi·ªÉm chung, v√≠ d·ª• IJ v√† LK." }
            ],
            hint: "C·∫°nh ƒë·ªëi l√† c·∫°nh kh√¥ng chung ƒë·ªânh v·ªõi nhau."
        }
    ];

    // Bi·∫øn tr·∫°ng th√°i tr√≤ ch∆°i
    let currentQuestionIndex = 0;
    let score = 0;
    let isAnswered = false;
    let currentShuffledOptions = []; // s·∫Ω ch·ª©a c√°c ƒë√°p √°n sau khi random cho m·ªói c√¢u

    // L·∫•y c√°c ph·∫ßn t·ª≠ DOM
    const startScreen = document.getElementById('start-screen');
    const quizContent = document.getElementById('quiz-content');
    const resultScreen = document.getElementById('result-screen');
    const startButton = document.getElementById('start-button');
    const restartButton = document.getElementById('restart-button');
    const questionText = document.getElementById('question-text');
    const difficultyLevel = document.getElementById('difficulty-level');
    const answerOptionsContainer = document.getElementById('answer-options');
    const rationaleBox = document.getElementById('rationale-box');
    const rationaleText = document.getElementById('rationale-text');
    const nextButton = document.getElementById('next-button');
    const progressBar = document.getElementById('progress');
    const scoreDisplay = document.getElementById('score-display');
    const resultMessage = document.getElementById('result-message');
    const confettiEmitter = document.getElementById('confetti-emitter');

    // H√†m shuffle m·∫£ng (Fisher‚ÄìYates)
    function shuffleArray(array) {
        const arr = array.map(opt => ({ ...opt })); // clone ƒë·ªÉ kh√¥ng ph√° d·ªØ li·ªáu g·ªëc
        for (let i = arr.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [arr[i], arr[j]] = [arr[j], arr[i]];
        }
        return arr;
    }

    // H√†m ph√°t √¢m thanh ch√∫c m·ª´ng (Web Audio API)
    function playCorrectSound() {
        try {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(600, audioContext.currentTime); // Chime pitch

            gainNode.gain.setValueAtTime(0, audioContext.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.5, audioContext.currentTime + 0.01);
            gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + 0.3);

            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.3);
        } catch (error) {
            console.error("Kh√¥ng th·ªÉ ph√°t √¢m thanh: ", error);
        }
    }

    // H√†m t·∫°o hi·ªáu ·ª©ng ph√°o hoa
    function createConfetti() {
        const colors = ['#f44336', '#e91e63', '#9c27b0', '#673ab7', '#3f51b5', '#2196f3', '#00bcd4', '#009688', '#4caf50', '#ffeb3b', '#ff9800', '#ff5722'];
        const count = 30;
        const containerWidth = confettiEmitter.offsetWidth;
        const containerHeight = confettiEmitter.offsetHeight;

        for (let i = 0; i < count; i++) {
            const confetti = document.createElement('div');
            confetti.className = 'confetti confetti-visible';
            confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            
            const x = (containerWidth / 2) + (Math.random() * 200 - 100);
            const y = (containerHeight / 2) + (Math.random() * 100 - 50);
            
            confetti.style.left = `${x}px`;
            confetti.style.top = `${y}px`;
            
            const angle = Math.random() * 360;
            const distance = 500 + Math.random() * 300;
            const duration = 1.5 + Math.random();

            confetti.animate([
                { transform: `translate(0, 0) rotate(0deg)`, opacity: 1 },
                { transform: `translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px) rotate(${Math.random() * 1080}deg)`, opacity: 0 }
            ], {
                duration: duration * 1000,
                easing: 'ease-out',
                fill: 'forwards'
            });

            confettiEmitter.appendChild(confetti);

            setTimeout(() => {
                confetti.remove();
            }, duration * 1000 + 50);
        }
    }

    // H√†m hi·ªÉn th·ªã c√¢u h·ªèi
    function displayQuestion() {
        rationaleBox.classList.add('hidden');
        nextButton.classList.add('hidden');
        answerOptionsContainer.innerHTML = '';
        isAnswered = false;

        if (currentQuestionIndex < quizQuestions.length) {
            const currentQ = quizQuestions[currentQuestionIndex];
            
            // C·∫≠p nh·∫≠t thanh ti·∫øn tr√¨nh
            const progressPercentage = (currentQuestionIndex / quizQuestions.length) * 100;
            progressBar.style.width = `${progressPercentage}%`;
            
            questionText.innerHTML = `C√¢u ${currentQuestionIndex + 1}/${quizQuestions.length}: ${currentQ.question}`;
            difficultyLevel.textContent = `M·ª©c ƒë·ªô: ${currentQ.level}`;

            // Random th·ª© t·ª± ƒë√°p √°n
            currentShuffledOptions = shuffleArray(currentQ.options);

            currentShuffledOptions.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'option-button w-full text-left p-3 rounded-lg border-2 border-red-200 bg-white text-gray-700 font-medium hover:bg-red-100 transition duration-150';
                button.innerHTML = `<span>${String.fromCharCode(65 + index)}. </span>${option.text}`;
                button.onclick = () => handleAnswer(button, option.isCorrect, currentShuffledOptions, currentQ.hint, currentQ.question, option.rationale);
                answerOptionsContainer.appendChild(button);
            });
        } else {
            showResult();
        }
    }

    // H√†m x·ª≠ l√Ω tr·∫£ l·ªùi
    function handleAnswer(selectedButton, isCorrect, options, hint, question, rationale) {
        if (isAnswered) return;
        isAnswered = true;

        const allButtons = answerOptionsContainer.querySelectorAll('button');
        allButtons.forEach(btn => btn.disabled = true);

        // options ·ªü ƒë√¢y l√† m·∫£ng ƒë√£ random -> ƒë√°nh d·∫•u theo ƒë√∫ng th·ª© t·ª± hi·ªÉn th·ªã
        options.forEach((option, index) => {
            const btn = allButtons[index];
            if (option.isCorrect) {
                btn.classList.add('correct-answer');
                btn.classList.remove('bg-white', 'hover:bg-red-100');
            } else if (btn === selectedButton && !option.isCorrect) {
                btn.classList.add('incorrect-answer');
                btn.classList.remove('bg-white', 'hover:bg-red-100');
            }
        });

        rationaleText.textContent = rationale;
        rationaleBox.classList.remove('hidden');

        if (isCorrect) {
            score++;
            playCorrectSound();
            createConfetti();
            selectedButton.innerHTML += ' <span class="ml-2">üéâüòä</span>';
        } else {
            selectedButton.innerHTML += ' <span class="ml-2">‚ùåüòî</span>';
        }

        nextButton.classList.remove('hidden');
    }

    // H√†m chuy·ªÉn sang c√¢u h·ªèi ti·∫øp theo
    function nextQuestion() {
        currentQuestionIndex++;
        displayQuestion();
    }

    // H√†m hi·ªÉn th·ªã k·∫øt qu·∫£
    function showResult() {
        quizContent.classList.add('hidden');
        startScreen.classList.add('hidden');
        resultScreen.classList.remove('hidden');

        const total = quizQuestions.length;
        scoreDisplay.textContent = score;
        let message = '';

        if (score === total) {
            message = "Xu·∫•t s·∫Øc! B·∫°n ƒë√£ ƒë·∫°t ƒëi·ªÉm tuy·ªát ƒë·ªëi. B·∫°n l√† m·ªôt chuy√™n gia v·ªÅ T·ª© gi√°c!";
        } else if (score >= total * 0.8) {
            message = "R·∫•t t·ªët! B·∫°n c√≥ ki·∫øn th·ª©c v·ªØng v√†ng v·ªÅ T·ª© gi√°c.";
        } else if (score >= total * 0.5) {
            message = "T·ªët! B·∫°n ƒë√£ n·∫Øm ƒë∆∞·ª£c nh·ªØng ki·∫øn th·ª©c c∆° b·∫£n. H√£y √¥n t·∫≠p th√™m c√°c c√¢u v·∫≠n d·ª•ng nh√©.";
        } else {
            message = "B·∫°n c·∫ßn c·ªë g·∫Øng h∆°n. H√£y xem l·∫°i c√°c ƒë·ªãnh nghƒ©a v√† quy t·∫Øc t·ªïng g√≥c trong T·ª© gi√°c nh√©!";
        }
        resultMessage.textContent = message;
        
        progressBar.style.width = `100%`;
    }

    // H√†m kh·ªüi ƒë·ªông l·∫°i tr√≤ ch∆°i
    function startQuiz() {
        currentQuestionIndex = 0;
        score = 0;
        isAnswered = false;
        startScreen.classList.add('hidden');
        resultScreen.classList.add('hidden');
        quizContent.classList.remove('hidden');
        displayQuestion();
    }

    // G√°n s·ª± ki·ªán cho c√°c n√∫t
    startButton.addEventListener('click', startQuiz);
    restartButton.addEventListener('click', startQuiz);
    nextButton.addEventListener('click', nextQuestion);

    progressBar.style.width = '0%';
    
    window.onload = () => {
        const rect = quizContent.getBoundingClientRect();
        confettiEmitter.style.position = 'absolute';
        confettiEmitter.style.top = `${rect.top}px`;
        confettiEmitter.style.left = `${rect.left}px`;
        confettiEmitter.style.width = `${rect.width}px`;
        confettiEmitter.style.height = `${rect.height}px`;
    };
</script>
</body>
</html>
