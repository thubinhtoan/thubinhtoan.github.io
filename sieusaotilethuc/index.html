<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SiÃªu Sao Tá»‰ Lá»‡ Thá»©c â€“ ToÃ¡n 7</title>

<!-- ===== MathJax chuáº©n Thá»£ sÄƒn kho bÃ¡u ===== -->
<script>
window.MathJax = {
  tex: {
    inlineMath: [['\\(', '\\)']],
    displayMath: [['\\[', '\\]']]
  },
  svg: { fontCache: 'global' }
};
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
body {
  font-family: 'Quicksand', sans-serif;
  background: linear-gradient(135deg,#fbc2eb,#a6c1ee);
  min-height:100vh;
}
.glass-card{
  background:rgba(255,255,255,.92);
  border-radius:2rem;
  box-shadow:0 20px 40px rgba(0,0,0,.25);
}
.btn-choice{transition:.25s}
.btn-choice:hover{transform:scale(1.03)}
.progress-bar{transition:width .4s}
</style>
</head>

<body class="p-4 flex items-center justify-center">

<div class="max-w-3xl w-full glass-card p-8">

<!-- START -->
<div id="start-screen" class="text-center">
  <h1 class="text-4xl font-bold text-pink-600 mb-4">âœ¨ SIÃŠU SAO Tá»ˆ Lá»† âœ¨</h1>
  <p class="mb-6 text-gray-600">Chinh phá»¥c 15 thá»­ thÃ¡ch Tá»‰ lá»‡ thá»©c â€“ ToÃ¡n 7</p>
  <button onclick="startGame()" class="bg-pink-500 text-white px-10 py-4 rounded-full text-xl font-bold">
    VÃ€O GAME ğŸš€
  </button>
</div>

<!-- QUIZ -->
<div id="quiz-screen" class="hidden">
  <div class="flex justify-between font-bold mb-4">
    <div>CÃ¢u <span id="current-q">1</span>/15</div>
    <div>Äiá»ƒm: <span id="score">0</span></div>
  </div>

  <div class="bg-gray-200 h-3 rounded-full mb-6">
    <div id="progress" class="bg-pink-400 h-3 rounded-full progress-bar"></div>
  </div>

  <div id="question-text" class="text-xl font-bold mb-6"></div>

  <div id="choices-container" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
</div>

<!-- FEEDBACK -->
<div id="feedback-modal" class="hidden fixed inset-0 flex items-center justify-center bg-black/40">
  <div class="glass-card p-8 text-center max-w-md w-full">
    <div id="fb-icon" class="text-5xl mb-3"></div>
    <h2 id="fb-title" class="text-2xl font-bold mb-2"></h2>
    <div id="fb-rationale" class="italic mb-6"></div>
    <button onclick="nextQuestion()" class="bg-blue-500 text-white px-8 py-3 rounded-xl font-bold">
      TIáº¾P Tá»¤C â†’
    </button>
  </div>
</div>

<!-- END -->
<div id="end-screen" class="hidden text-center">
  <h2 class="text-4xl font-bold text-purple-600 mb-4">ğŸ‰ HOÃ€N THÃ€NH ğŸ‰</h2>
  <p class="text-xl">Sá»‘ cÃ¢u Ä‘Ãºng: <span id="final-score" class="text-pink-500 font-bold text-3xl"></span>/15</p>
  <p id="performance-msg" class="mt-4 font-semibold"></p>
  <button onclick="location.reload()" class="mt-6 bg-green-500 text-white px-8 py-3 rounded-full font-bold">
    CHÆ I Láº I
  </button>
</div>

</div>

<script>
/* ===== Ã‚M THANH ===== */
const audioCtx = new (window.AudioContext||window.webkitAudioContext)();
function playSound(ok){
  const o=audioCtx.createOscillator(), g=audioCtx.createGain();
  o.connect(g); g.connect(audioCtx.destination);
  o.frequency.value= ok?700:200;
  g.gain.value=.1;
  o.start(); o.stop(audioCtx.currentTime+.2);
}

/* ===== DATA (CHUáº¨N LATEX) ===== */
let questions=[
{
 q:"Tá»‰ lá»‡ thá»©c lÃ  Ä‘áº³ng thá»©c cá»§a hai tá»‰ sá»‘ nÃ o?",
 options:["\\(a+b=c+d\\)","\\(a/b=c/d\\)","\\(a-b=c-b\\)","\\(ab=cd\\)"],
 correct:1,
 rationale:"Theo Ä‘á»‹nh nghÄ©a, tá»‰ lá»‡ thá»©c lÃ  Ä‘áº³ng thá»©c cá»§a hai tá»‰ sá»‘ \\(a/b=c/d\\)."
},
{
 q:"Trong tá»‰ lá»‡ thá»©c \\(x/6=5/3\\), giÃ¡ trá»‹ cá»§a \\(x\\) lÃ :",
 options:["\\(10\\)","\\(15\\)","\\(2\\)","\\(30\\)"],
 correct:0,
 rationale:"Ta cÃ³ \\(x=(6\\cdot5):3=10\\)."
},
{
 q:"Náº¿u \\(3:5=9:x\\) thÃ¬ \\(x=\\)?",
 options:["\\(10\\)","\\(12\\)","\\(15\\)","\\(20\\)"],
 correct:2,
 rationale:"VÃ¬ \\(3x=5\\cdot9=45\\) nÃªn \\(x=15\\)."
}
];

/* ===== RANDOM CÃ‚U Há»I ===== */
questions.sort(()=>Math.random()-.5);

let i=0, score=0;

/* ===== START ===== */
function startGame(){
 document.getElementById("start-screen").classList.add("hidden");
 document.getElementById("quiz-screen").classList.remove("hidden");
 showQuestion();
}

/* ===== SHOW ===== */
function showQuestion(){
 const q=questions[i];
 document.getElementById("current-q").innerText=i+1;
 document.getElementById("score").innerText=score;
 document.getElementById("progress").style.width=`${i/questions.length*100}%`;

 document.getElementById("question-text").innerHTML=q.q;

 const ctn=document.getElementById("choices-container");
 ctn.innerHTML="";

 let idx=[0,1,2,3].sort(()=>Math.random()-.5);
 idx.forEach(k=>{
   const b=document.createElement("button");
   b.className="btn-choice bg-white border p-4 rounded-xl font-semibold";
   b.innerHTML=q.options[k];
   b.onclick=()=>checkAnswer(k);
   ctn.appendChild(b);
 });

 MathJax.typesetPromise();
}

/* ===== CHECK ===== */
function checkAnswer(k){
 const q=questions[i];
 document.getElementById("feedback-modal").classList.remove("hidden");

 if(k===q.correct){
   score++; playSound(true);
   confetti({particleCount:120,spread:70});
   document.getElementById("fb-icon").innerText="ğŸ‰";
   document.getElementById("fb-title").innerText="ChÃ­nh xÃ¡c!";
 } else {
   playSound(false);
   document.getElementById("fb-icon").innerText="ğŸ˜…";
   document.getElementById("fb-title").innerText="ChÆ°a Ä‘Ãºng!";
 }

 document.getElementById("fb-rationale").innerHTML="Giáº£i thÃ­ch: "+q.rationale;
 MathJax.typesetPromise();
}

/* ===== NEXT ===== */
function nextQuestion(){
 document.getElementById("feedback-modal").classList.add("hidden");
 i++;
 if(i<questions.length) showQuestion();
 else showEnd();
}

/* ===== END ===== */
function showEnd(){
 document.getElementById("quiz-screen").classList.add("hidden");
 document.getElementById("end-screen").classList.remove("hidden");
 document.getElementById("final-score").innerText=score;
 document.getElementById("performance-msg").innerText=
  score===questions.length?"Xuáº¥t sáº¯c! ğŸŒŸ":"Cá»‘ gáº¯ng thÃªm nhÃ©!";
 confetti({particleCount:200,spread:160});
}
</script>

</body>
</html>
