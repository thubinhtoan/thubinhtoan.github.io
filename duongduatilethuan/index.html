<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ÄÆ°á»ng Äua Tá»‰ Lá»‡ Thuáº­n - ToÃ¡n 7</title>

<!-- ===== MathJax chuáº©n Thá»£ sÄƒn kho bÃ¡u ===== -->
<script>
window.MathJax = {
  tex: {
    inlineMath: [['\\(', '\\)']],
    displayMath: [['\\[', '\\]']]
  },
  svg: { fontCache: 'global' }
};
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body {
  font-family: 'Quicksand', sans-serif;
  background: linear-gradient(135deg, #85FFBD 0%, #FFFB7D 100%);
  min-height: 100vh;
}
.glass-panel {
  background: rgba(255, 255, 255, 0.92);
  border-radius: 2.5rem;
  box-shadow: 0 20px 50px rgba(0,0,0,0.1);
}
.choice-btn { transition: 0.2s }
.choice-btn:active { transform: scale(0.95) }
</style>
</head>

<body class="p-4 flex items-center justify-center">

<div id="game-app" class="max-w-2xl w-full glass-panel p-6 md:p-10">

<!-- START -->
<div id="start-screen" class="text-center">
  <div class="text-6xl mb-6">ğŸï¸ğŸ’¨</div>
  <h1 class="text-4xl font-extrabold text-teal-600 mb-4">ÄÆ¯á»œNG ÄUA Tá»ˆ Lá»† THUáº¬N</h1>
  <p class="mb-6 text-gray-600">Chinh phá»¥c kiáº¿n thá»©c ToÃ¡n 7 â€“ Tá»‰ lá»‡ thuáº­n</p>
  <button onclick="startGame()" class="bg-teal-500 text-white px-10 py-4 rounded-full font-bold text-xl">
    START ğŸ
  </button>
</div>

<!-- QUIZ -->
<div id="quiz-screen" class="hidden">
  <div class="flex justify-between mb-4 font-bold">
    <div>CÃ¢u <span id="q-num">1</span>/<span id="total-q"></span></div>
    <div>Äiá»ƒm: <span id="score">0</span></div>
  </div>

  <div class="bg-gray-200 h-2 rounded-full mb-6">
    <div id="progress" class="bg-teal-500 h-2 rounded-full"></div>
  </div>

  <div id="q-level" class="text-sm text-teal-600 font-bold mb-2"></div>
  <div id="question-text" class="text-xl font-bold mb-6"></div>
  <div id="choices-grid" class="grid gap-4"></div>
</div>

<!-- FEEDBACK -->
<div id="feedback-modal" class="hidden fixed inset-0 flex items-center justify-center bg-black/40">
  <div class="bg-white p-6 rounded-3xl max-w-sm w-full text-center">
    <div id="fb-icon" class="text-5xl mb-3"></div>
    <h3 id="fb-title" class="text-2xl font-bold mb-2"></h3>
    <div id="fb-rationale" class="italic mb-6 text-sm"></div>
    <button onclick="nextQuestion()" class="bg-teal-500 text-white px-6 py-3 rounded-xl font-bold">
      TIáº¾P Tá»¤C â†’
    </button>
  </div>
</div>

<!-- END -->
<div id="end-screen" class="hidden text-center">
  <h2 class="text-3xl font-bold mb-4">ğŸ Vá»€ ÄÃCH!</h2>
  <p class="text-xl mb-4">Äiá»ƒm cá»§a em: <span id="final-score"></span></p>
  <div id="rank-msg" class="mb-6 font-semibold"></div>
  <button onclick="location.reload()" class="bg-gray-800 text-white px-8 py-3 rounded-full">
    CHÆ I Láº I
  </button>
</div>

</div>

<script>
/* ===== Ã‚M THANH ===== */
const audioCtx = new (window.AudioContext||window.webkitAudioContext)();
function playSound(ok){
  const o=audioCtx.createOscillator(), g=audioCtx.createGain();
  o.frequency.value=ok?700:200;
  g.gain.value=.1;
  o.connect(g); g.connect(audioCtx.destination);
  o.start(); o.stop(audioCtx.currentTime+.2);
}

/* ===== DATA (ÄÃƒ CHUáº¨N HOÃ LATEX) ===== */
let questions = [
{
 level:"Nháº­n biáº¿t",
 q:"Náº¿u Ä‘áº¡i lÆ°á»£ng \\(y\\) liÃªn há»‡ vá»›i \\(x\\) theo cÃ´ng thá»©c \\(y=kx\\) (\\(k\\ne0\\)) thÃ¬:",
 options:[
  "y tá»‰ lá»‡ thuáº­n vá»›i x theo há»‡ sá»‘ k",
  "x tá»‰ lá»‡ thuáº­n vá»›i y theo há»‡ sá»‘ k",
  "y tá»‰ lá»‡ nghá»‹ch vá»›i x",
  "x vÃ  y khÃ´ng tá»‰ lá»‡"
 ],
 correct:0,
 rationale:"Theo Ä‘á»‹nh nghÄ©a, \\(y=kx\\) nghÄ©a lÃ  \\(y\\) tá»‰ lá»‡ thuáº­n vá»›i \\(x\\) theo há»‡ sá»‘ \\(k\\)."
},
{
 level:"Nháº­n biáº¿t",
 q:"Cho \\(y=-3x\\). Há»‡ sá»‘ tá»‰ lá»‡ lÃ :",
 options:["3","-3","1/3","-1/3"],
 correct:1,
 rationale:"Trong \\(y=kx\\), há»‡ sá»‘ tá»‰ lá»‡ lÃ  sá»‘ Ä‘á»©ng trÆ°á»›c \\(x\\), á»Ÿ Ä‘Ã¢y lÃ  \\(-3\\)."
}
];

/* ===== RANDOM CÃ‚U ===== */
questions.sort(()=>Math.random()-0.5);

let i=0, score=0;

/* ===== START ===== */
document.getElementById("total-q").innerText = questions.length;

function startGame(){
 document.getElementById("start-screen").classList.add("hidden");
 document.getElementById("quiz-screen").classList.remove("hidden");
 showQuestion();
}

/* ===== SHOW ===== */
function showQuestion(){
 const q=questions[i];
 document.getElementById("q-num").innerText=i+1;
 document.getElementById("score").innerText=score;
 document.getElementById("q-level").innerText="Cáº¥p Ä‘á»™: "+q.level;
 document.getElementById("question-text").innerHTML=q.q;
 document.getElementById("progress").style.width=`${i/questions.length*100}%`;

 const grid=document.getElementById("choices-grid");
 grid.innerHTML="";

 let order=q.options.map((opt,idx)=>({opt,idx}))
                   .sort(()=>Math.random()-0.5);

 order.forEach(item=>{
  const btn=document.createElement("button");
  btn.className="choice-btn bg-white border p-4 rounded-xl text-left";
  btn.innerHTML=item.opt;
  btn.onclick=()=>checkAnswer(item.idx);
  grid.appendChild(btn);
 });

 MathJax.typesetPromise();
}

/* ===== CHECK ===== */
function checkAnswer(idx){
 const q=questions[i];
 const ok=idx===q.correct;

 playSound(ok);
 if(ok){
  score++;
  confetti({particleCount:120,spread:70});
  fb-icon.innerText="ğŸ‰";
  fb-title.innerText="ChÃ­nh xÃ¡c!";
 } else {
  fb-icon.innerText="ğŸ˜…";
  fb-title.innerText="ChÆ°a Ä‘Ãºng!";
 }

 document.getElementById("fb-rationale").innerHTML="Giáº£i thÃ­ch: "+q.rationale;
 document.getElementById("feedback-modal").classList.remove("hidden");
 MathJax.typesetPromise();
}

/* ===== NEXT ===== */
function nextQuestion(){
 document.getElementById("feedback-modal").classList.add("hidden");
 i++;
 if(i<questions.length) showQuestion();
 else showEnd();
}

/* ===== END ===== */
function showEnd(){
 document.getElementById("quiz-screen").classList.add("hidden");
 document.getElementById("end-screen").classList.remove("hidden");
 document.getElementById("final-score").innerText=score+"/"+questions.length;
 document.getElementById("rank-msg").innerText=
  score===questions.length?"Xuáº¥t sáº¯c ğŸ†":"Cá»‘ gáº¯ng thÃªm nhÃ©!";
 confetti({particleCount:200,spread:160});
}
</script>
</body>
</html>
