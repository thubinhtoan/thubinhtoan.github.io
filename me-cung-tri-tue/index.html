<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MÃª Cung TrÃ­ Tuá»‡ - ToÃ¡n 9: GÃ³c á»Ÿ tÃ¢m, gÃ³c ná»™i tiáº¿p</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Tone.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            padding: 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #game-container {
            width: 100%;
            max-width: 950px;
            background: rgba(255,255,255,0.97);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,0.25);
        }
        header {
            background: #1e3a8a;
            color: white;
            padding: 1.5rem;
            text-align: center;
            border-bottom: 4px solid #172554;
        }
        #maze-grid {
            display: grid;
            grid-template-columns: repeat(3,1fr);
            gap: 1rem;
            padding: 1.5rem;
        }
        .maze-door {
            aspect-ratio: 1/1;
            background: #e5e7eb;
            border-radius: 12px;
            font-size: 2.5rem;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px solid #cbd5e1;
            transition: .4s;
        }
        .maze-door.unlocked {
            background: #bbf7d0;
            border-color: #4ade80;
            transform: scale(1.08);
        }
        #options-container button {
            box-shadow: 0 3px 6px rgba(0,0,0,0.08);
        }
        .option-btn.correct {
            background: #dcfce7 !important;
            border-color: #4ade80 !important;
        }
        .option-btn.wrong {
            background: #fee2e2 !important;
            border-color: #f87171 !important;
        }
        .feedback-effect {
            position: absolute;
            font-size: 4rem;
            animation: fadeUp 1s forwards;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }
        @keyframes fadeUp {
            from { opacity: 1; transform: translate(-50%, -50%) scale(0.6); }
            to { opacity: 0; transform: translate(-50%, -120%) scale(1.2); }
        }
    </style>
</head>

<body>
<div id="game-container">

    <header>
        <h1 class="text-3xl font-bold">MÃª Cung TrÃ­ Tuá»‡</h1>
        <p>BÃ i 3: GÃ³c á»Ÿ tÃ¢m, gÃ³c ná»™i tiáº¿p - ToÃ¡n 9</p>
    </header>

    <main class="md:flex">

        <!-- MÃŠ CUNG -->
        <div id="maze-grid" class="md:w-2/5 bg-gray-100 border-r">
            <!-- 15 cá»­a -->
            <script>
                for (let i = 1; i <= 15; i++) {
                    document.write(`<div id="door-${i}" class="maze-door">${i === 15 ? "ğŸ†" : "ğŸšª"}</div>`);
                }
            </script>
        </div>

        <!-- CÃ‚U Há»I -->
        <div id="quiz-area" class="md:w-3/5 p-6 relative">

            <div id="question-container">
                <div id="question-level" class="text-sm font-semibold bg-blue-100 text-blue-700 px-3 py-1 rounded-full inline-block mb-3">
                    Má»©c Ä‘á»™
                </div>
                <div id="question-text" class="text-lg font-medium mb-4">ÄÃ¢y lÃ  cÃ¢u há»i...</div>

                <div id="options-container" class="grid gap-3"></div>
            </div>

            <div id="controls" class="flex justify-between items-center mt-4">
                <span id="progress-text" class="text-sm font-semibold text-gray-700">Cá»­a 1/15</span>
                <button id="control-btn"
                        class="bg-blue-600 text-white font-semibold px-6 py-2 rounded-lg"
                        disabled>Má»Ÿ cá»­a</button>
            </div>

            <div id="feedback-container"></div>

            <div id="end-screen" class="hidden text-center mt-10">
                <h2 class="text-3xl font-bold text-blue-700 mb-4">ChÃºc má»«ng!</h2>
                <p id="end-score" class="text-xl mb-4"></p>
                <button id="restart-btn"
                        class="bg-blue-500 text-white py-2 px-6 rounded-lg font-semibold">ChÆ¡i láº¡i</button>
            </div>
        </div>
    </main>

</div>

<script>
/* ============================
   DANH SÃCH CÃ‚U Há»I (ÄÃƒ Bá» $)
   ============================ */
const questions = [
    { level: "Nháº­n biáº¿t", text: "GÃ³c á»Ÿ tÃ¢m lÃ  gÃ³c cÃ³ Ä‘á»‰nh trÃ¹ng vá»›i tÃ¢m Ä‘Æ°á»ng trÃ²n.",
      options: [
        {text:"ÄÃºng", correct:true},
        {text:"Sai", correct:false}
      ]},

    { level:"Nháº­n biáº¿t", text:"GÃ³c ná»™i tiáº¿p lÃ  gÃ³c cÃ³ Ä‘á»‰nh náº±m trÃªn Ä‘Æ°á»ng trÃ²n vÃ  hai cáº¡nh chá»©a hai dÃ¢y cung.",
      options:[
          {text:"ÄÃºng", correct:true},
          {text:"Sai", correct:false}
      ]},

    { level:"Nháº­n biáº¿t", text:"Sá»‘ Ä‘o gÃ³c ná»™i tiáº¿p báº±ng ná»­a sá»‘ Ä‘o cung bá»‹ cháº¯n.",
      options:[{text:"ÄÃºng",correct:true},{text:"Sai",correct:false}]
    },

    { level:"Nháº­n biáº¿t", text:"Cung nhá» 70Â°, thÃ¬ cung lá»›n cÃ¹ng cháº¯n lÃ  290Â°.",
      options:[{text:"ÄÃºng",correct:true},{text:"Sai",correct:false}]
    },

    { level:"Nháº­n biáº¿t", text:"GÃ³c ná»™i tiáº¿p cháº¯n ná»­a Ä‘Æ°á»ng trÃ²n báº±ng 90Â°.",
      options:[{text:"ÄÃºng",correct:true},{text:"Sai",correct:false}]
    },

    { level:"ThÃ´ng hiá»ƒu",
      text:"GÃ³c ná»™i tiáº¿p cháº¯n cung 120Â° cÃ³ sá»‘ Ä‘o 60Â°.",
      options:[{text:"ÄÃºng",correct:true},{text:"Sai",correct:false}]
    },

    { level:"ThÃ´ng hiá»ƒu",
      text:"GÃ³c á»Ÿ tÃ¢m cháº¯n cung 80Â° cÃ³ sá»‘ Ä‘o 80Â°.",
      options:[{text:"ÄÃºng",correct:true},{text:"Sai",correct:false}]
    },

    { level:"ThÃ´ng hiá»ƒu",
      text:"GÃ³c ná»™i tiáº¿p 55Â° cháº¯n cung 110Â°.",
      options:[{text:"ÄÃºng",correct:true},{text:"Sai",correct:false}]
    },

    { level:"ThÃ´ng hiá»ƒu",
      text:"Hai gÃ³c ná»™i tiáº¿p cÃ¹ng cháº¯n má»™t cung thÃ¬ báº±ng nhau.",
      options:[{text:"ÄÃºng",correct:true},{text:"Sai",correct:false}]
    },

    { level:"Váº­n dá»¥ng",
      text:"Tam giÃ¡c ABC ná»™i tiáº¿p, gÃ³c A=65Â°, B=80Â°. Sá»‘ Ä‘o cung AB báº±ng 70Â°.",
      options:[{text:"ÄÃºng",correct:true},{text:"Sai",correct:false}]
    },

    { level:"Váº­n dá»¥ng",
      text:"TrÃªn Ä‘Æ°á»ng trÃ²n, gÃ³c ná»™i tiáº¿p ADC cháº¯n cung 150Â° thÃ¬ gÃ³c ADC = 75Â°.",
      options:[{text:"ÄÃºng",correct:true},{text:"Sai",correct:false}]
    },

    { level:"Váº­n dá»¥ng",
      text:"Má»™t cáº§u thá»§ di chuyá»ƒn trÃªn cung trÃ²n Ä‘i qua M, N, A thÃ¬ gÃ³c MAN khÃ´ng Ä‘á»•i.",
      options:[{text:"ÄÃºng",correct:true},{text:"Sai",correct:false}]
    },

    { level:"Váº­n dá»¥ng cao",
      {
    level: "Váº­n dá»¥ng cao",
    text: "Cho Ä‘Æ°á»ng trÃ²n (O) cÃ³ Ä‘Æ°á»ng kÃ­nh AB. C lÃ  má»™t Ä‘iá»ƒm báº¥t ká»³ trÃªn Ä‘Æ°á»ng trÃ²n. Káº» CH vuÃ´ng gÃ³c vá»›i AB táº¡i H. Láº¥y Ä‘iá»ƒm M trÃªn cung nhá» AC. Gá»i I lÃ  giao Ä‘iá»ƒm cá»§a AM vá»›i CH. Khi Ä‘Ã³ IC = IH. Kháº³ng Ä‘á»‹nh trÃªn Ä‘Ãºng hay sai?",
    options: [
        { text: "ÄÃºng", correct: true },
        { text: "Sai", correct: false }
      }
];

/* ============================
   BIáº¾N TRáº NG THÃI
   ============================ */
let current = 0, score = 0;
let selected = null;
let correctSound, wrongSound, soundReady = false;

/* ============================
   DOM
   ============================ */
const questionContainer = document.getElementById("question-container");
const questionLevelEl = document.getElementById("question-level");
const questionTextEl = document.getElementById("question-text");
const optionsContainer = document.getElementById("options-container");
const progressText = document.getElementById("progress-text");
const controlBtn = document.getElementById("control-btn");
const feedbackContainer = document.getElementById("feedback-container");
const endScreen = document.getElementById("end-screen");
const endScoreEl = document.getElementById("end-score");
const restartBtn = document.getElementById("restart-btn");
const controls = document.getElementById("controls");   /* FIX Lá»–I QUAN TRá»ŒNG */

/* ============================
   KHá»I Äá»˜NG GAME
   ============================ */
document.addEventListener("DOMContentLoaded", startGame);

function startGame() {
    document.body.addEventListener("click", initAudio, {once:true});
    current = 0;
    score = 0;

    endScreen.classList.add("hidden");
    questionContainer.classList.remove("hidden");
    controls.classList.remove("hidden");

    for (let i = 1; i <= 15; i++) {
        const d = document.getElementById(`door-${i}`);
        d.classList.remove("unlocked");
        d.textContent = i === 15 ? "ğŸ†" : "ğŸšª";
    }

    loadQuestion();
}

function initAudio() {
    if (soundReady) return;
    Tone.start();

    correctSound = new Tone.Synth().toDestination();
    wrongSound = new Tone.Synth({oscillator:{type:"square"}}).toDestination();

    soundReady = true;
}

/* ============================
   HIá»‚N THá»Š CÃ‚U Há»I
   ============================ */
function loadQuestion() {
    if (current >= questions.length) return endGame();

    const q = questions[current];
    questionLevelEl.textContent = "Má»©c Ä‘á»™: " + q.level;
    questionTextEl.textContent = q.text;

    progressText.textContent = `Cá»­a ${current+1}/15`;

    optionsContainer.innerHTML = "";
    selected = null;

    q.options.forEach((opt, idx)=>{
        const btn = document.createElement("button");
        btn.className = "option-btn w-full border px-4 py-2 rounded-lg bg-white text-left";
        btn.textContent = opt.text;

        btn.onclick = ()=>{
            document.querySelectorAll(".option-btn").forEach(b=>b.classList.remove("selected"));
            btn.classList.add("selected");
            selected = idx;
            controlBtn.disabled = false;
        };

        optionsContainer.appendChild(btn);
    });

    controlBtn.textContent = "Má»Ÿ cá»­a";
    controlBtn.disabled = true;
}

controlBtn.onclick = ()=>{
    if (controlBtn.textContent === "Má»Ÿ cá»­a") checkAnswer();
    else nextQuestion();
};

function checkAnswer() {
    const q = questions[current];
    const correctIndex = q.options.findIndex(o=>o.correct);

    const btns = document.querySelectorAll(".option-btn");
    btns.forEach(b=>b.disabled=true);

    if (selected === correctIndex) {
        score++;
        btns[selected].classList.add("correct");
        unlockDoor(current+1);
        playEffect("âœ”ï¸");
    } else {
        btns[selected].classList.add("wrong");
        btns[correctIndex].classList.add("correct");
        playEffect("ğŸ˜¢");
    }

    controlBtn.textContent = "Tiáº¿p tá»¥c";
}

function nextQuestion() {
    current++;
    loadQuestion();
}

function endGame() {
    questionContainer.classList.add("hidden");
    controls.classList.add("hidden");
    endScreen.classList.remove("hidden");
    endScoreEl.textContent = `Báº¡n Ä‘Ã£ má»Ÿ Ä‘Ãºng ${score}/15 cÃ¡nh cá»­a!`;

    const d = document.getElementById("door-15");
    d.classList.add("unlocked");
}

restartBtn.onclick = startGame;

/* ============================
   HIá»†U á»¨NG
   ============================ */
function unlockDoor(i) {
    const d = document.getElementById(`door-${i}`);
    d.classList.add("unlocked");
    d.textContent = "âœ”ï¸";
}

function playEffect(icon) {
    const eff = document.createElement("div");
    eff.className = "feedback-effect";
    eff.textContent = icon;
    feedbackContainer.appendChild(eff);
    setTimeout(()=>eff.remove(),1000);
}
</script>

</body>
</html>
