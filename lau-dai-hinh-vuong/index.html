<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>L√¢u ƒê√†i H√¨nh Vu√¥ng ‚Äì Thu B√¨nh To√°n (Game 10)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- React + ReactDOM -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <!-- Babel ƒë·ªÉ d√πng JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="m-0 p-0 bg-slate-950">
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;

    // ================== C√ÇU H·ªéI GAME 10 ‚Äì H√åNH VU√îNG ==================
    // 15 c√¢u, ƒë√£ c√¢n b·∫±ng ƒë√°p √°n A/B/C/D v√† ki·ªÉm tra l·∫°i k·∫øt qu·∫£
    const questions = [
      // --- NH·∫¨N BI·∫æT (6 c√¢u) ---
      {
        id: 1,
        level: "Nh·∫≠n bi·∫øt",
        question: "Kh·∫≥ng ƒë·ªãnh n√†o sau ƒë√¢y ƒë√∫ng nh·∫•t v·ªÅ h√¨nh vu√¥ng?",
        options: [
          "T·ª© gi√°c c√≥ b·ªën g√≥c vu√¥ng",
          "T·ª© gi√°c c√≥ b·ªën c·∫°nh b·∫±ng nhau",
          "T·ª© gi√°c c√≥ b·ªën c·∫°nh b·∫±ng nhau v√† b·ªën g√≥c vu√¥ng",
          "T·ª© gi√°c c√≥ hai c·∫∑p c·∫°nh ƒë·ªëi song song"
        ],
        correct: 2 // C
      },
      {
        id: 2,
        level: "Nh·∫≠n bi·∫øt",
        question: "Trong c√°c t·ª© gi√°c sau, t·ª© gi√°c n√†o CH·∫ÆC CH·∫ÆN l√† h√¨nh vu√¥ng?",
        options: [
          "T·ª© gi√°c c√≥ b·ªën g√≥c vu√¥ng",
          "T·ª© gi√°c c√≥ b·ªën c·∫°nh b·∫±ng nhau",
          "H√¨nh ch·ªØ nh·∫≠t c√≥ hai c·∫°nh k·ªÅ b·∫±ng nhau",
          "H√¨nh b√¨nh h√†nh c√≥ hai ƒë∆∞·ªùng ch√©o b·∫±ng nhau"
        ],
        correct: 2 // C
      },
      {
        id: 3,
        level: "Nh·∫≠n bi·∫øt",
        question: "H√¨nh vu√¥ng ABCD c√≥ AB = 5 cm. Chu vi c·ªßa h√¨nh vu√¥ng l√†:",
        options: [
          "20 cm",
          "10 cm",
          "25 cm",
          "5 cm"
        ],
        correct: 0 // A (P = 4¬∑5 = 20)
      },
      {
        id: 4,
        level: "Nh·∫≠n bi·∫øt",
        question: "Trong h√¨nh vu√¥ng, hai ƒë∆∞·ªùng ch√©o c√≥ t√≠nh ch·∫•t:",
        options: [
          "B·∫±ng nhau nh∆∞ng kh√¥ng c·∫Øt nhau t·∫°i trung ƒëi·ªÉm",
          "B·∫±ng nhau, vu√¥ng g√≥c v√† c·∫Øt nhau t·∫°i trung ƒëi·ªÉm",
          "Kh√¥ng b·∫±ng nhau v√† kh√¥ng c·∫Øt nhau",
          "Vu√¥ng g√≥c nh∆∞ng kh√¥ng c·∫Øt nhau"
        ],
        correct: 1 // B
      },
      {
        id: 5,
        level: "Nh·∫≠n bi·∫øt",
        question: "Kh·∫≥ng ƒë·ªãnh n√†o sau ƒë√¢y lu√¥n ƒë√∫ng v·ªõi m·ªçi h√¨nh vu√¥ng?",
        options: [
          "C√≥ th·ªÉ coi l√† m·ªôt h√¨nh ch·ªØ nh·∫≠t ƒë·∫∑c bi·ªát",
          "Kh√¥ng ph·∫£i l√† h√¨nh b√¨nh h√†nh",
          "Ch·ªâ c√≥ m·ªôt tr·ª•c ƒë·ªëi x·ª©ng",
          "Chu vi lu√¥n l·ªõn h∆°n 100 cm"
        ],
        correct: 0 // A
      },
      {
        id: 6,
        level: "Nh·∫≠n bi·∫øt",
        question: "D·∫•u hi·ªáu n√†o sau ƒë√¢y KH√îNG d√πng ƒë·ªÉ ch·ª©ng minh m·ªôt t·ª© gi√°c l√† h√¨nh vu√¥ng?",
        options: [
          "T·ª© gi√°c l√† h√¨nh ch·ªØ nh·∫≠t v√† c√≥ hai c·∫°nh k·ªÅ b·∫±ng nhau",
          "T·ª© gi√°c l√† h√¨nh thoi v√† c√≥ m·ªôt g√≥c vu√¥ng",
          "T·ª© gi√°c l√† h√¨nh ch·ªØ nh·∫≠t v√† c√≥ hai ƒë∆∞·ªùng ch√©o vu√¥ng g√≥c",
          "T·ª© gi√°c c√≥ hai c·∫∑p c·∫°nh ƒë·ªëi song song"
        ],
        correct: 3 // D (m·ªõi ch·ªâ l√† h√¨nh b√¨nh h√†nh)
      },

      // --- TH√îNG HI·ªÇU (5 c√¢u) ---
      {
        id: 7,
        level: "Th√¥ng hi·ªÉu",
        question: "M·ªôt h√¨nh vu√¥ng c√≥ c·∫°nh 6 cm. Di·ªán t√≠ch c·ªßa h√¨nh vu√¥ng l√†:",
        options: [
          "36 cm¬≤",
          "12 cm¬≤",
          "24 cm¬≤",
          "18 cm¬≤"
        ],
        correct: 0 // A (S = 6¬∑6 = 36)
      },
      {
        id: 8,
        level: "Th√¥ng hi·ªÉu",
        question: "M·ªôt h√¨nh vu√¥ng c√≥ di·ªán t√≠ch 49 cm¬≤. ƒê·ªô d√†i c·∫°nh h√¨nh vu√¥ng l√†:",
        options: [
          "6 cm",
          "7 cm",
          "14 cm",
          "3,5 cm"
        ],
        correct: 1 // B (c·∫°nh = ‚àö49 = 7)
      },
      {
        id: 9,
        level: "Th√¥ng hi·ªÉu",
        question: "M·ªôt h√¨nh vu√¥ng c√≥ chu vi 32 cm. Di·ªán t√≠ch h√¨nh vu√¥ng ƒë√≥ l√†:",
        options: [
          "16 cm¬≤",
          "32 cm¬≤",
          "64 cm¬≤",
          "128 cm¬≤"
        ],
        correct: 2 // C (c·∫°nh = 8 ‚áí S = 64)
      },
      {
        id: 10,
        level: "Th√¥ng hi·ªÉu",
        question: "Cho h√¨nh ch·ªØ nh·∫≠t ABCD, n·∫øu AB = BC th√¨ ABCD l√† h√¨nh g√¨?",
        options: [
          "H√¨nh ch·ªØ nh·∫≠t",
          "H√¨nh vu√¥ng",
          "H√¨nh thoi",
          "H√¨nh b√¨nh h√†nh"
        ],
        correct: 1 // B
      },
      {
        id: 11,
        level: "Th√¥ng hi·ªÉu",
        question: "M·ªôt s√¢n ch∆°i h√¨nh vu√¥ng c√≥ c·∫°nh 6 m. Ng∆∞·ªùi ta l√°t to√†n b·ªô s√¢n b·∫±ng g·∫°ch h√¨nh vu√¥ng c·∫°nh 0,5 m. S·ªë vi√™n g·∫°ch c·∫ßn d√πng l√†:",
        options: [
          "72 vi√™n",
          "144 vi√™n",
          "64 vi√™n",
          "100 vi√™n"
        ],
        correct: 1 // B (S s√¢n = 36; S g·∫°ch = 0,25 ‚áí 36 / 0,25 = 144)
      },

      // --- V·∫¨N D·ª§NG (3 c√¢u) ---
      {
        id: 12,
        level: "V·∫≠n d·ª•ng",
        question: "H√¨nh vu√¥ng c√≥ ƒë∆∞·ªùng ch√©o d√†i 10 cm. ƒê·ªô d√†i c·∫°nh h√¨nh vu√¥ng l√†:",
        options: [
          "5 cm",
          "10 cm",
          "2‚àö5 cm",
          "5‚àö2 cm"
        ],
        correct: 3 // D (c·∫°nh = 10 / ‚àö2 = 5‚àö2)
      },
      {
        id: 13,
        level: "V·∫≠n d·ª•ng",
        question: "M·ªôt h√¨nh vu√¥ng c√≥ c·∫°nh x (cm). C√¥ng th·ª©c t√≠nh di·ªán t√≠ch h√¨nh vu√¥ng l√†:",
        options: [
          "x¬≤",
          "2x",
          "4x",
          "x¬≤ : 2"
        ],
        correct: 2 - 2 // =0, nh∆∞ng vi·∫øt r√µ cho d·ªÖ nh√¨n: A ‚Äì x¬≤
      },
      {
        id: 14,
        level: "V·∫≠n d·ª•ng",
        question: "M·ªôt khung h√¨nh vu√¥ng ƒë∆∞·ª£c l√†m t·ª´ 4 thanh g·ªó, m·ªói c·∫°nh d√†i 0,8 m. Gi√° 1 m g·ªó l√† 20 000 ƒë·ªìng. Ti·ªÅn mua g·ªó ƒë·ªÉ l√†m khung l√†:",
        options: [
          "64 000 ƒë·ªìng",
          "32 000 ƒë·ªìng",
          "80 000 ƒë·ªìng",
          "16 000 ƒë·ªìng"
        ],
        correct: 0 // A (P = 3,2 m ‚áí 3,2¬∑20 000 = 64 000)
      },

      // --- V·∫¨N D·ª§NG CAO (1 c√¢u) ---
      {
        id: 15,
        level: "V·∫≠n d·ª•ng cao",
        question: "Cho h√¨nh vu√¥ng ABCD. G·ªçi M, N, P, Q l·∫ßn l∆∞·ª£t l√† trung ƒëi·ªÉm c·ªßa AB, BC, CD, DA. T·ª© gi√°c MNPQ l√† h√¨nh g√¨?",
        options: [
          "H√¨nh ch·ªØ nh·∫≠t",
          "H√¨nh thoi",
          "H√¨nh vu√¥ng",
          "H√¨nh b√¨nh h√†nh"
        ],
        correct: 2 // C (n·ªëi trung ƒëi·ªÉm c√°c c·∫°nh c·ªßa h√¨nh vu√¥ng ƒë∆∞·ª£c m·ªôt h√¨nh vu√¥ng m·ªõi)
      }
    ];

    // ================== √ÇM THANH ƒê∆†N GI·∫¢N ==================
    const playSound = (type) => {
      const AudioContext = window.AudioContext || window.webkitAudioContext;
      if (!AudioContext) return;
      const ctx = new AudioContext();
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      const now = ctx.currentTime;

      if (type === "correct") {
        osc.type = "sine";
        osc.frequency.setValueAtTime(440, now);
        osc.frequency.setValueAtTime(660, now + 0.1);
        osc.frequency.setValueAtTime(880, now + 0.2);
        gain.gain.setValueAtTime(0.12, now);
        gain.gain.exponentialRampToValueAtTime(0.01, now + 0.5);
        osc.start(now);
        osc.stop(now + 0.5);
      } else if (type === "wrong") {
        osc.type = "square";
        osc.frequency.setValueAtTime(160, now);
        osc.frequency.linearRampToValueAtTime(80, now + 0.25);
        gain.gain.setValueAtTime(0.15, now);
        gain.gain.linearRampToValueAtTime(0, now + 0.25);
        osc.start(now);
        osc.stop(now + 0.25);
      }

      osc.connect(gain);
      gain.connect(ctx.destination);
    };

    // ================== CONFETTI ==================
    const Confetti = () => (
      <div className="absolute inset-0 pointer-events-none overflow-hidden z-40">
        {[...Array(30)].map((_, i) => (
          <div
            key={i}
            className="absolute w-2 h-2 rounded-full"
            style={{
              backgroundColor: ['#e5e7eb', '#22c55e', '#38bdf8', '#f97316'][i % 4],
              left: `${Math.random() * 100}%`,
              top: `-10px`,
              animation: `fall ${1 + Math.random() * 2}s linear forwards`,
              animationDelay: `${Math.random() * 0.5}s`
            }}
          />
        ))}
        <style>{`
          @keyframes fall {
            to { transform: translateY(100vh) rotate(720deg); opacity: 0; }
          }
        `}</style>
      </div>
    );

    // ================== L√ÇU ƒê√ÄI H√åNH VU√îNG ==================
    const SquareCastleView = ({ score }) => {
      const correctCount = score / 10;
      const level =
        correctCount === 0 ? 0 :
        correctCount < 5 ? 1 :
        correctCount < 11 ? 2 : 3;

      return (
        <div className="relative w-full max-w-md mx-auto bg-slate-900/80 border border-sky-400/60 rounded-2xl p-4 shadow-lg">
          <h3 className="text-sm font-semibold text-sky-300 mb-2 flex items-center gap-2">
            <span>üè∞</span>
            <span>Ti·∫øn ƒë·ªô x√¢y L√¢u ƒê√†i H√¨nh Vu√¥ng</span>
          </h3>

          <div className="relative mx-auto my-2 w-56 h-56 bg-slate-950/80 rounded-3xl border-4 border-slate-700 flex items-center justify-center overflow-hidden">
            {/* N·ªÅn */}
            <div className="absolute inset-4 bg-gradient-to-br from-slate-900 via-slate-950 to-sky-900 rounded-2xl" />

            {/* Khung vu√¥ng t∆∞·ªùng ngo√†i */}
            {level >= 1 && (
              <div className="absolute inset-8 border-4 border-amber-600 rounded-lg shadow-[0_0_15px_rgba(245,158,11,0.8)]" />
            )}

            {/* T∆∞·ªùng trong + th√°p */}
            {level >= 2 && (
              <>
                <div className="absolute inset-16 border-4 border-amber-400 rounded-lg" />
                <div className="absolute top-8 left-8 text-xl">üõ°Ô∏è</div>
                <div className="absolute top-8 right-8 text-xl">üõ°Ô∏è</div>
                <div className="absolute bottom-8 left-8 text-xl">üõ°Ô∏è</div>
                <div className="absolute bottom-8 right-8 text-xl">üõ°Ô∏è</div>
              </>
            )}

            {/* Kim c∆∞∆°ng trung t√¢m */}
            <div className="absolute inset-0 flex items-center justify-center">
              <div className="relative">
                <div className="absolute inset-0 blur-xl bg-cyan-400/40 rounded-full animate-pulse" />
                <div className="relative text-4xl">
                  {correctCount === 0 ? "üí†" : "üíé"}
                </div>
              </div>
            </div>

            {/* V∆∞∆°ng mi·ªán khi ho√†n th√†nh cao */}
            {level >= 3 && (
              <div className="absolute -top-3 left-1/2 -translate-x-1/2 text-3xl">
                üëë
              </div>
            )}
          </div>

          {/* Ti·∫øn ƒë·ªô ph·∫ßn trƒÉm */}
          <div className="mt-3">
            <div className="flex justify-between text-[11px] text-slate-300 mb-1">
              <span>ƒê·ªô ho√†n m·ªπ c·ªßa l√¢u ƒë√†i</span>
              <span>{Math.round((correctCount / questions.length) * 100)}%</span>
            </div>
            <div className="w-full h-2 rounded-full bg-slate-800 overflow-hidden">
              <div
                className="h-full bg-gradient-to-r from-sky-400 via-emerald-400 to-yellow-400 transition-all duration-500"
                style={{ width: `${(correctCount / questions.length) * 100}%` }}
              />
            </div>
          </div>

          <p className="mt-2 text-[11px] text-slate-400">
            M·ªói c√¢u ƒë√∫ng l√†m vi√™n kim c∆∞∆°ng s√°ng h∆°n v√† l√¢u ƒë√†i vu√¥ng v·ª©c, ho√†n m·ªπ h∆°n. 
          </p>
        </div>
      );
    };

    // ================== MAIN GAME COMPONENT ==================
    function SquareCastleGame() {
      const [gameState, setGameState] = useState("intro"); // intro, playing, end
      const [currentQ, setCurrentQ] = useState(0);
      const [score, setScore] = useState(0);
      const [feedback, setFeedback] = useState(null); // 'correct' | 'wrong' | null
      const [soundOn, setSoundOn] = useState(true);

      const handleStart = () => {
        setGameState("playing");
        setCurrentQ(0);
        setScore(0);
        setFeedback(null);
      };

      const handleAnswer = (index) => {
        if (feedback) return;
        const isCorrect = index === questions[currentQ].correct;

        if (isCorrect) {
          setFeedback("correct");
          setScore((s) => s + 10);
          if (soundOn) playSound("correct");
        } else {
          setFeedback("wrong");
          if (soundOn) playSound("wrong");
        }

        setTimeout(() => {
          setFeedback(null);
          if (currentQ < questions.length - 1) {
            setCurrentQ((q) => q + 1);
          } else {
            setGameState("end");
          }
        }, 1800);
      };

      const correctCount = score / 10;

      return (
        <div className="min-h-screen flex items-center justify-center bg-slate-950 text-white relative overflow-hidden">
          {/* Background */}
          <div className="absolute inset-0 bg-gradient-to-br from-slate-900 via-slate-950 to-sky-900 opacity-90" />
          <div className="absolute inset-0 pointer-events-none opacity-25">
            {[...Array(30)].map((_, i) => (
              <div
                key={i}
                className="absolute w-1 h-1 rounded-full bg-sky-300"
                style={{
                  top: `${Math.random() * 100}%`,
                  left: `${Math.random() * 100}%`,
                  boxShadow: "0 0 8px rgba(56,189,248,0.8)"
                }}
              />
            ))}
          </div>

          {/* N√∫t √¢m thanh */}
          <button
            onClick={() => setSoundOn((v) => !v)}
            className="absolute top-4 right-4 z-20 px-3 py-2 text-xs sm:text-sm bg-white/10 hover:bg-white/20 rounded-full"
          >
            {soundOn ? "üîä √Çm thanh: B·∫¨T" : "üîá √Çm thanh: T·∫ÆT"}
          </button>

          {/* MAIN CARD */}
          <div className="relative z-10 w-full max-w-5xl mx-4 bg-slate-900/80 border border-sky-400/60 rounded-3xl shadow-2xl overflow-hidden backdrop-blur-xl">
            {/* Header */}
            <header className="px-6 sm:px-10 py-4 border-b border-sky-400/60 bg-gradient-to-r from-sky-500/40 to-cyan-400/20 flex items-center justify-between gap-3 flex-wrap">
              <div>
                <div className="text-xs uppercase tracking-wide text-sky-200/80 mb-1">
                  Thu B√¨nh To√°n ‚Äì Game 10
                </div>
                <h1 className="text-xl sm:text-2xl font-bold flex items-center gap-2">
                  <span className="text-2xl">üíé</span>
                  <span>L√¢u ƒê√†i H√¨nh Vu√¥ng ‚Äì B·∫£o v·ªá vi√™n kim c∆∞∆°ng ho√†n m·ªπ</span>
                </h1>
                <p className="text-xs sm:text-sm text-slate-200/90">
                  To√°n 8 ‚Äì H√¨nh vu√¥ng ¬∑ M·ªói c√¢u tr·∫£ l·ªùi ƒë√∫ng gi√∫p l√¢u ƒë√†i vu√¥ng v·∫Øn, vi√™n kim c∆∞∆°ng s√°ng h∆°n.
                </p>
              </div>
              <div className="flex flex-col items-end text-[11px] sm:text-xs text-sky-100">
                <span>
                  C√¢u:{" "}
                  {gameState === "playing" ? currentQ + 1 : 0}/{questions.length}
                </span>
                <span>ƒêi·ªÉm: {score}</span>
              </div>
            </header>

            {/* BODY */}
            <main className="p-4 sm:p-6 md:p-8">
              {/* INTRO */}
              {gameState === "intro" && (
                <div className="flex flex-col items-center text-center gap-6 py-8">
                  <div className="relative">
                    <div className="absolute inset-0 bg-sky-400 blur-3xl opacity-40 animate-pulse" />
                    <div className="relative w-32 h-32 sm:w-40 sm:h-40 rounded-3xl border border-sky-400/60 flex items-center justify-center bg-slate-900/80 shadow-[0_0_40px_rgba(56,189,248,0.8)]">
                      <span className="text-5xl sm:text-6xl">üíé</span>
                    </div>
                  </div>
                  <h2 className="text-3xl sm:text-4xl font-extrabold text-sky-300 drop-shadow">
                    X√¢y L√¢u ƒê√†i H√¨nh Vu√¥ng Ho√†n M·ªπ
                  </h2>
                  <p className="text-sm sm:text-base text-slate-200 max-w-xl">
                    M·ªói c√¢u tr·∫£ l·ªùi ƒë√∫ng s·∫Ω l√†m <strong>t∆∞·ªùng l√¢u ƒë√†i vu√¥ng v·ª©c h∆°n</strong> 
                    v√† <strong>vi√™n kim c∆∞∆°ng trung t√¢m s√°ng r·ª±c</strong>. 
                    Ho√†n th√†nh 15 c√¢u h·ªèi ƒë·ªÉ b·∫£o v·ªá vi√™n kim c∆∞∆°ng ho√†n m·ªπ kh·ªèi m·ªçi k·∫ª x√¢m nh·∫≠p!
                  </p>
                  <button
                    onClick={handleStart}
                    className="mt-2 px-8 py-3 rounded-full bg-sky-400 hover:bg-sky-300 text-slate-950 font-bold text-lg shadow-lg shadow-sky-400/40 transform hover:-translate-y-0.5 active:translate-y-0 transition-all"
                  >
                    B·∫ÆT ƒê·∫¶U X√ÇY L√ÇU ƒê√ÄI üè∞
                  </button>
                </div>
              )}

              {/* PLAYING */}
              {gameState === "playing" && (
                <div className="flex flex-col md:flex-row gap-6">
                  {/* C·ªôt tr√°i: L√¢u ƒë√†i */}
                  <div className="md:w-1/3 flex flex-col items-center gap-4">
                    <SquareCastleView score={score} />
                    <div className="text-center text-[11px] text-slate-300 mt-2">
                      C√¢u ƒë√∫ng:{" "}
                      <span className="font-semibold text-sky-300">
                        {correctCount}
                      </span>{" "}
                      / {questions.length}
                    </div>
                  </div>

                  {/* C·ªôt ph·∫£i: C√¢u h·ªèi */}
                  <div className="md:w-2/3 bg-slate-900/80 border border-slate-700 rounded-2xl p-4 sm:p-6 relative overflow-hidden">
                    <div className="absolute top-0 right-0 w-24 h-24 bg-sky-500/10 rounded-bl-full pointer-events-none" />
                    <span className="absolute -top-3 -right-3 px-3 py-1 bg-sky-600 text-xs font-bold rounded-full uppercase tracking-wider border border-sky-300 shadow-lg">
                      {questions[currentQ].level}
                    </span>

                    <h3 className="text-lg sm:text-xl font-semibold mb-4 text-slate-50">
                      {questions[currentQ].question}
                    </h3>

                    <div className="grid grid-cols-1 gap-3 mt-2">
                      {questions[currentQ].options.map((opt, idx) => {
                        let base =
                          "w-full text-left px-4 py-3 rounded-xl border text-sm sm:text-base transition-all";
                        let style =
                          "border-slate-600 bg-slate-800/80 hover:bg-slate-700/80 text-slate-100";

                        if (feedback) {
                          if (idx === questions[currentQ].correct) {
                            style =
                              "border-sky-400 bg-sky-900/60 text-sky-100 shadow-[0_0_18px_rgba(56,189,248,0.7)]";
                          } else if (feedback === "wrong") {
                            style =
                              "border-slate-700 bg-slate-900/70 text-slate-500 opacity-60";
                          }
                        }

                        return (
                          <button
                            key={idx}
                            disabled={!!feedback}
                            onClick={() => handleAnswer(idx)}
                            className={base + " " + style}
                          >
                            <span className="font-semibold mr-2">
                              {["A.", "B.", "C.", "D."][idx]}
                            </span>
                            {opt}
                          </button>
                        );
                      })}
                    </div>

                    {feedback === "wrong" && (
                      <div className="absolute inset-0 bg-black/40 flex items-center justify-center pointer-events-none">
                        <div className="px-4 py-2 rounded-full bg-red-600 text-white text-sm font-semibold shadow-lg">
                          Sai m·∫•t r·ªìi! L√¢u ƒë√†i rung chuy·ªÉn m·ªôt ch√∫t, th·ª≠ c·∫©n th·∫≠n h∆°n ·ªü c√¢u sau nh√© üò¢
                        </div>
                      </div>
                    )}
                    {feedback === "correct" && (
                      <>
                        <Confetti />
                        <div className="absolute inset-0 bg-black/30 flex items-center justify-center pointer-events-none">
                          <div className="px-4 py-2 rounded-full bg-sky-400 text-slate-900 text-sm font-semibold shadow-lg">
                            Ch√≠nh x√°c! L√¢u ƒë√†i v·ª´a vu√¥ng v·ª©c h∆°n v√† vi√™n kim c∆∞∆°ng s√°ng h∆°n üíé
                          </div>
                        </div>
                      </>
                    )}
                  </div>
                </div>
              )}

              {/* END */}
              {gameState === "end" && (
                <div className="flex flex-col items-center text-center gap-6 py-8">
                  <div className="relative">
                    <div className="absolute inset-0 bg-yellow-400 blur-3xl opacity-40 animate-pulse" />
                    <div className="relative w-32 h-32 sm:w-40 sm:h-40 rounded-3xl border border-yellow-400/60 flex items-center justify-center bg-slate-900/80 shadow-[0_0_40px_rgba(250,204,21,0.9)]">
                      <span className="text-5xl sm:text-6xl">üëë</span>
                    </div>
                  </div>
                  <h2 className="text-3xl sm:text-4xl font-extrabold text-yellow-300 drop-shadow">
                    L√¢u ƒê√†i H√¨nh Vu√¥ng Ho√†n M·ªπ!
                  </h2>
                  <p className="text-sm sm:text-base text-slate-200 max-w-xl">
                    B·∫°n ƒë√£ tr·∫£ l·ªùi ƒë√∫ng{" "}
                    <span className="font-bold text-sky-300">
                      {correctCount}
                    </span>{" "}
                    / {questions.length} c√¢u.
                    Vi√™n kim c∆∞∆°ng ƒë√£ ƒë∆∞·ª£c b·∫£o v·ªá b·ªüi m·ªôt l√¢u ƒë√†i vu√¥ng v·ª©c, ki√™n c·ªë v√† ho√†n m·ªπ!
                  </p>

                  <div className="flex flex-col sm:flex-row gap-4 justify-center text-sm sm:text-base">
                    <div className="px-4 py-3 rounded-2xl bg-slate-900/80 border border-slate-700 min-w-[140px]">
                      <div className="text-slate-300 text-xs uppercase mb-1">
                        T·ªïng ƒëi·ªÉm
                      </div>
                      <div className="text-2xl font-bold text-sky-400">
                        {score}
                      </div>
                    </div>
                    <div className="px-4 py-3 rounded-2xl bg-slate-900/80 border border-slate-700 min-w-[140px]">
                      <div className="text-slate-300 text-xs uppercase mb-1">
                        Danh hi·ªáu
                      </div>
                      <div className="text-lg font-bold text-yellow-300">
                        {score >= 130
                          ? "Vua L√¢u ƒê√†i Kim C∆∞∆°ng"
                          : score >= 100
                          ? "Hi·ªáp Sƒ© B·∫£o H·ªô"
                          : "Ng∆∞·ªùi G√°c C·ªïng D≈©ng C·∫£m"}
                      </div>
                    </div>
                  </div>

                  <button
                    onClick={() => {
                      setGameState("intro");
                      setCurrentQ(0);
                      setScore(0);
                      setFeedback(null);
                    }}
                    className="mt-2 px-8 py-3 rounded-full bg-sky-400 hover:bg-sky-300 text-slate-950 font-bold text-lg shadow-lg shadow-sky-400/40 transform hover:-translate-y-0.5 active:translate-y-0 transition-all"
                  >
                    CH∆†I L·∫†I T·ª™ ƒê·∫¶U üîÅ
                  </button>
                </div>
              )}
            </main>

            <footer className="px-6 sm:px-10 py-3 text-[11px] text-slate-400 border-t border-slate-800 bg-slate-950/80 text-center">
              To√°n 8 ‚Äì H√¨nh vu√¥ng ‚Äì L√¢u ƒê√†i H√¨nh Vu√¥ng ‚Äì Thu B√¨nh To√°n üíö
            </footer>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<SquareCastleGame />);
  </script>
</body>
</html>
